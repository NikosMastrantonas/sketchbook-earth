

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Chapter 2: Taking Earth’s Temperature &#8212; Sketchbook Earth &#34;:&#34; Illustrated Climate Chronicles</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '02a_temperature';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Chapter 2: Taking Earth’s Temperature" href="02b_temperature.html" />
    <link rel="prev" title="Chapter 1: Greenhouses Gases - The prime suspect" href="01_greenhouse_gases.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo_transparent.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo_transparent.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Sketchbook Earth: Illustrated Climate Chronicles
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapter 1: Greenhouse Gases - The prime suspect</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01_greenhouse_gases.html">Long-Term Development of CO2 and CH4 Concentrations</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapter 2: Taking Earth’s Temperature</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">It's getting hot(ter) in here: Long-Term Development of Global Earth Temperature Since 1850</a></li>
<li class="toctree-l1"><a class="reference internal" href="02b_temperature.html">Comparing Re-analysis with Observations since 1950</a></li>
<li class="toctree-l1"><a class="reference internal" href="02c_temperature.html">Visualising Recent Temperature Anomalies</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapter 3: Journey to the Frozen Sea</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="03_sea_ice.html">Chapter 3: Journey to the Frozen Sea</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapter 4: Rising Seas</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="04_sea_level.html">Sea Level Anomalies</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapter 5: Ta Panta Rhei... (Everything Flows)</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="05_animations.html">Animations and Interactive Plots</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/NikosMastrantonas/sketchbook-earth" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/NikosMastrantonas/sketchbook-earth/issues/new?title=Issue%20on%20page%20%2F02a_temperature.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/02a_temperature.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Chapter 2: Taking Earth’s Temperature</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-i-it-s-getting-hot-ter-in-here-long-term-development-of-global-earth-temperature-since-1850">Part I: It’s getting hot(ter) in here: Long-Term Development of Global Earth Temperature Since 1850</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-set-up-your-toolkit">Getting Set Up: Your Toolkit</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-streamline-the-data">Download and streamline the data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#noaa-globaltemp">NOAA GlobalTemp</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#berkeley-earth">Berkeley Earth</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#gistemp">GISTEMP</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hadcrut5">HadCRUT5</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#era5-reanalysis">ERA5 reanalysis</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculation-of-spatial-averages">Calculation of Spatial Averages</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-model-discrepancies">Understanding Model Discrepancies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#wrapping-up-with-earth-s-temperature">Wrapping Up with Earth’s Temperature</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#in-retrospect">In Retrospect…</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chapter-2-taking-earth-s-temperature">
<h1>Chapter 2: Taking Earth’s Temperature<a class="headerlink" href="#chapter-2-taking-earth-s-temperature" title="Permalink to this heading">#</a></h1>
<section id="part-i-it-s-getting-hot-ter-in-here-long-term-development-of-global-earth-temperature-since-1850">
<h2>Part I: It’s getting hot(ter) in here: Long-Term Development of Global Earth Temperature Since 1850<a class="headerlink" href="#part-i-it-s-getting-hot-ter-in-here-long-term-development-of-global-earth-temperature-since-1850" title="Permalink to this heading">#</a></h2>
<p>Imagine a doctor’s thermometer, but one that’s designed to gauge the health of our planet. As a fever reveals a person’s illness, Earth’s rising temperature exposes a global condition that’s equally concerning. This chapter, much like a medical investigation, unfolds the diagnosis of Earth’s thermal well-being.</p>
<p>The previous chapter delved into the enigmatic world of greenhouse gases, namely carbon dioxide and methane, elucidating how their concentrations are increasing in our atmosphere. Now, we turn our lens to scrutinise the surface temperature of our Earth, which is also on the rise, a tell-tale symptom of increasing GHGs (greenhouse gases).</p>
<p>We have meticulously divided this chapter into three comprehensive notebooks, each focusing on a distinctive aspect:</p>
<ol class="arabic simple">
<li><p>Long-Term Development of Global Earth Temperature Since 1850 (<span class="xref myst">this notebook</span>)</p></li>
<li><p>Comparing Re-analysis with Observations since 1950</p></li>
<li><p>Visualising Recent Temperature Anomalies</p></li>
</ol>
<div class="alert alert-block alert-success">
<b>Objective:</b> <br>
    Our aim here is to perform a historical examination, comparing the global surface temperature from 1850-2022 using various authoritative data sources. We will stitch together a monthly resolved time series that paints the average surface anomaly over the past ~250 years. The grand finale? A common plot that showcases these time series. </a>
</div><p>Here’s an overview of the datasets we’ll employ:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Dataset</p></th>
<th class="head text-center"><p>Spatial Coverage</p></th>
<th class="head text-center"><p>Spatial Resolution</p></th>
<th class="head text-center"><p>Temporal Coverage</p></th>
<th class="head text-center"><p>Temporal resolution</p></th>
<th class="head text-center"><p>Provider</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>NOAAGlobalTempv5</p></td>
<td class="text-center"><p>Global</p></td>
<td class="text-center"><p>5º x 5º</p></td>
<td class="text-center"><p>1850 - today</p></td>
<td class="text-center"><p>Monthly</p></td>
<td class="text-center"><p>NOAA</p></td>
</tr>
<tr class="row-odd"><td><p>Berkeley Earth</p></td>
<td class="text-center"><p>Global</p></td>
<td class="text-center"><p>1º x 1º</p></td>
<td class="text-center"><p>1850 - today</p></td>
<td class="text-center"><p>Monthly</p></td>
<td class="text-center"><p>Berkeley Earth</p></td>
</tr>
<tr class="row-even"><td><p>GISTEMPv4</p></td>
<td class="text-center"><p>Global</p></td>
<td class="text-center"><p>2º x 2º</p></td>
<td class="text-center"><p>1880 - today</p></td>
<td class="text-center"><p>Monthly</p></td>
<td class="text-center"><p>NASA</p></td>
</tr>
<tr class="row-odd"><td><p>HadCRUT5</p></td>
<td class="text-center"><p>Global</p></td>
<td class="text-center"><p>5º x 5º</p></td>
<td class="text-center"><p>1850 - today</p></td>
<td class="text-center"><p>Monthly</p></td>
<td class="text-center"><p>Met Office Hadley Centre</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://cds.climate.copernicus.eu/cdsapp#!/dataset/reanalysis-era5-single-levels-monthly-means?tab=overview">ERA5</a></p></td>
<td class="text-center"><p>Global</p></td>
<td class="text-center"><p>0.25º x 0.25º</p></td>
<td class="text-center"><p>1940 - today</p></td>
<td class="text-center"><p>Monthly</p></td>
<td class="text-center"><p>C3S/ECMWF</p></td>
</tr>
</tbody>
</table>
<p>Additionally, we’ll wield the land-sea mask created by the respective provider to weight the datasets accurately.</p>
<p><strong>Here’s what to expect:</strong></p>
<ul class="simple">
<li><p><strong>Downloading, opening, and streamlining datasets</strong>: From providers as diverse as the climate they track.</p></li>
<li><p><strong>Handling moderate data volumes</strong> (~ 5 GB): No worries, <a class="reference external" href="https://www.dask.org/"><code class="docutils literal notranslate"><span class="pre">dask</span></code></a> will take care of the work.</p></li>
<li><p><strong>Calculating spatially and temporally correct averages</strong>: Like taking Earth’s temperature, but with mathematics.</p></li>
<li><p><strong>Estimating uncertainties</strong>: A vital step in this scientific expedition, achieved through ensemble members.</p></li>
</ul>
<style>
td, th {
   border: 1px solid white;
   border-collapse: collapse;
}
</style>
<table align="left">
  <tr>
    <th>Run the tutorial via free cloud platforms: </th>
    <th><a href="https://mybinder.org/v2/gh/ecmwf-projects/copernicus-training-cams/master?labpath=vis-animations.ipynb">
        <img src = "https://mybinder.org/badge.svg" alt = "Binder"></th>
    <th><a href="https://kaggle.com/kernels/welcome?src=https://github.com/ecmwf-projects/copernicus-training-cams/blob/master/vis-animations.ipynb">
        <img src = "https://kaggle.com/static/images/open-in-kaggle.svg" alt = "Kaggle"></th>
    <th><a href="https://colab.research.google.com/github/ecmwf-projects/copernicus-training-cams/blob/master/vis-animations.ipynb">
        <img src = "https://colab.research.google.com/assets/colab-badge.svg" alt = "Colab"></th>
  </tr>
</table><hr class="docutils" />
<section id="getting-set-up-your-toolkit">
<h3>Getting Set Up: Your Toolkit<a class="headerlink" href="#getting-set-up-your-toolkit" title="Permalink to this heading">#</a></h3>
<p>Prepare for our planetary health check by importing all necessary packages:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Python Standard Libraries</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">zipfile</span>
<span class="kn">import</span> <span class="nn">urllib.request</span>

<span class="c1"># Data Manipulation Libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">regionmask</span> <span class="k">as</span> <span class="nn">rm</span>
<span class="kn">import</span> <span class="nn">dask</span>

<span class="c1"># Visualization Libraries</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.dates</span> <span class="k">as</span> <span class="nn">mdates</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">cartopy.feature</span> <span class="k">as</span> <span class="nn">cfeature</span>
<span class="kn">from</span> <span class="nn">dask.diagnostics.progress</span> <span class="kn">import</span> <span class="n">ProgressBar</span>

<span class="c1"># Climate Data Store API for retrieving climate data</span>
<span class="kn">import</span> <span class="nn">cdsapi</span>
</pre></div>
</div>
</div>
</div>
<p>The following cell ensures a consistent figure layout. If you’re running this notebook on one of the cloud platforms, the stylesheet may not be present by default. No worries, you can either upload the file or ignore the following cell. It’s about styling, and while it won’t affect your calculations, aesthetics matter, don’t they?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;../copernicus.mplstyle&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Additionally, we instruct dask to avoid the creation of large chunks that may arise in different calculations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dask</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s2">&quot;array.slicing.split_large_chunks&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;dask.config.set at 0x7fc451416710&gt;
</pre></div>
</div>
</div>
</div>
<p>With the <code class="docutils literal notranslate"><span class="pre">regionmask</span></code> package, you’ll craft a land-sea mask for any <code class="docutils literal notranslate"><span class="pre">xr.DataArray</span></code>, something you’ll need later if our chosen data provider doesn’t offer additional weights.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Boolean land-sea mask</span>
<span class="n">lsm</span> <span class="o">=</span> <span class="n">rm</span><span class="o">.</span><span class="n">defined_regions</span><span class="o">.</span><span class="n">natural_earth_v5_0_0</span><span class="o">.</span><span class="n">land_110</span>
</pre></div>
</div>
</div>
</div>
<p>Here’s where your creativity shines. Define the <code class="docutils literal notranslate"><span class="pre">REGIONS</span></code> that captivate your curiosity. Since the underlying data (except ERA5) might be relatively coarse, make your regions generous enough to ensure sufficient data. While we followed the definitions used in the <a class="reference external" href="https://climate.copernicus.eu/esotc/2022/about-data#Regiondefinitions">C3S Climate Intelligence reports</a>, feel free to change them or to add your own regions of interest! Your playground is as vast as the planet itself:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">REGIONS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Global&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">),</span> <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">)},</span>
    <span class="s2">&quot;Northern Hemisphere&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">),</span> <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">)},</span>
    <span class="s2">&quot;Southern Hemisphere&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">),</span> <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">0</span><span class="p">)},</span>
    <span class="s2">&quot;Europe&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">34</span><span class="p">,</span> <span class="mi">72</span><span class="p">)},</span>
    <span class="s2">&quot;Arctic&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">),</span> <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mf">66.6</span><span class="p">,</span> <span class="mi">90</span><span class="p">)},</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>This is the stage where you pick your time frame for examining climatology. For instance, you could use the currently valid period of 1991-2020.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">REF_PERIOD</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;1991&quot;</span><span class="p">,</span> <span class="s2">&quot;2020&quot;</span><span class="p">)}</span>
</pre></div>
</div>
</div>
</div>
<p>Since we are tapping into different data sources that all come in their format and peculiarities, let’s organize the data in folders for a better overview.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file_name</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># dictionary containing [data source : file name]</span>

<span class="c1"># Berkeley Earth</span>
<span class="n">file_name</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;berkeley&quot;</span><span class="p">:</span> <span class="s2">&quot;temperature_berkeley.nc&quot;</span><span class="p">})</span>  

<span class="c1"># GISTEMP</span>
<span class="n">file_name</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;gistemp_250km&quot;</span><span class="p">:</span> <span class="s2">&quot;temperature_gistemp_250km.gz&quot;</span><span class="p">})</span>  <span class="c1"># higher resolution</span>
<span class="n">file_name</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;gistemp_1200km&quot;</span><span class="p">:</span> <span class="s2">&quot;temperature_gistemp_1200km.gz&quot;</span><span class="p">})</span>  <span class="c1"># lower resolution</span>
<span class="n">file_name</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;gistemp_lsm&quot;</span><span class="p">:</span> <span class="s2">&quot;temperature_gistemp_lsm.txt&quot;</span><span class="p">})</span>  <span class="c1"># land sea mask</span>

<span class="c1"># HadCRUT</span>
<span class="n">file_name</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;hadcrut&quot;</span><span class="p">:</span> <span class="s2">&quot;temperature_hadcrut.nc&quot;</span><span class="p">})</span>
<span class="n">file_name</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;hadcrut_lsm&quot;</span><span class="p">:</span> <span class="s2">&quot;temperature_hadcrut_lsm.nc&quot;</span><span class="p">})</span>  <span class="c1"># land sea mask</span>
<span class="n">file_name</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;hadcrut_members&quot;</span><span class="p">:</span> <span class="s2">&quot;temperature_hadcrut_ensemble_members.zip&quot;</span><span class="p">})</span>  <span class="c1"># ensemble members</span>

<span class="c1"># ERA5</span>
<span class="n">file_name</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;era5&quot;</span><span class="p">:</span> <span class="s2">&quot;temperature_era5.nc&quot;</span><span class="p">})</span>

<span class="c1"># Create the paths to the files</span>
<span class="n">path_to</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">source</span><span class="p">,</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">file_name</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">root</span> <span class="o">=</span> <span class="s2">&quot;data/</span><span class="si">{:}</span><span class="s2">/&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">source</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">path_to</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">source</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">file</span><span class="p">)})</span>
</pre></div>
</div>
</div>
</div>
<p>Create necessary directories if they don’t exist:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">file</span><span class="p">,</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">path_to</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:&lt;15}</span><span class="s2"> --&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">path</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>berkeley        --&gt; data/berkeley/temperature_berkeley.nc
gistemp_250km   --&gt; data/gistemp/temperature_gistemp_250km.gz
gistemp_1200km  --&gt; data/gistemp/temperature_gistemp_1200km.gz
gistemp_lsm     --&gt; data/gistemp/temperature_gistemp_lsm.txt
hadcrut         --&gt; data/hadcrut/temperature_hadcrut.nc
hadcrut_lsm     --&gt; data/hadcrut/temperature_hadcrut_lsm.nc
hadcrut_members --&gt; data/hadcrut/temperature_hadcrut_ensemble_members.zip
era5            --&gt; data/era5/temperature_era5.nc
</pre></div>
</div>
</div>
</div>
<p>As we will see, the various data also come with different conventions regarding dimension names and coordinates. We make our work much easier by ensuring at the beginning that all data is in the same format. In our case, we want to streamline datasets as follows:</p>
<ul class="simple">
<li><p>Dimension names are (<code class="docutils literal notranslate"><span class="pre">time</span></code>, <code class="docutils literal notranslate"><span class="pre">lon</span></code>, <code class="docutils literal notranslate"><span class="pre">lat</span></code>)</p></li>
<li><p>The monthly resolved time coordinate is in <code class="docutils literal notranslate"><span class="pre">datetime</span></code> format and fixed to the beginning of the month</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">lon</span></code> and <code class="docutils literal notranslate"><span class="pre">lat</span></code> coordinates are sorted by their values</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">lon</span></code> coordinate is defined from -180 to +180º (as opposed to 0 to 360º)</p></li>
</ul>
<p>The following function <code class="docutils literal notranslate"><span class="pre">streamline_coords</span></code> will take care of these operations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">streamline_coords</span><span class="p">(</span><span class="n">da</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Streamline the dimensions and coordinates of a DataArray.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    da : xr.DataArray</span>
<span class="sd">        The DataArray to streamline.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Ensure that time coordinate is fixed to the first day of the month</span>
    <span class="k">if</span> <span class="s2">&quot;time&quot;</span> <span class="ow">in</span> <span class="n">da</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
        <span class="c1"># if already datetime, just ensure that it is the first day of the month</span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_datetime64_any_dtype</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">time</span><span class="p">):</span>
            <span class="n">da</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">da</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_index</span><span class="p">()</span><span class="o">.</span><span class="n">to_period</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_timestamp</span><span class="p">()</span>
        <span class="c1"># if float, convert to datetime</span>
        <span class="k">elif</span> <span class="n">da</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">float</span><span class="p">:</span>
            <span class="n">first_year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">time_coord</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">cftime_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">first_year</span><span class="si">}</span><span class="s2">-01-01&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="n">da</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;MS&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_datetimeindex</span><span class="p">()</span>
            <span class="n">da</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time_coord</span>
        <span class="c1"># else ¯\_(ツ)_/¯</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Time coordinate is of type </span><span class="si">{</span><span class="n">da</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2">, but must be either datetime or float.&quot;</span>
            <span class="p">)</span>

    <span class="c1"># Ensure that spatial coordinates are called &#39;lon&#39; and &#39;lat&#39;</span>
    <span class="k">if</span> <span class="s2">&quot;longitude&quot;</span> <span class="ow">in</span> <span class="n">da</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;longitude&quot;</span><span class="p">:</span> <span class="s2">&quot;lon&quot;</span><span class="p">})</span>
    <span class="k">if</span> <span class="s2">&quot;latitude&quot;</span> <span class="ow">in</span> <span class="n">da</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;latitude&quot;</span><span class="p">:</span> <span class="s2">&quot;lat&quot;</span><span class="p">})</span>

    <span class="c1"># Ensure that lon/lat are sorted in ascending order</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="s2">&quot;lat&quot;</span><span class="p">)</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="s2">&quot;lon&quot;</span><span class="p">)</span>

    <span class="c1"># Ensure that lon is in the range [-180, 180]</span>
    <span class="n">lon_min</span> <span class="o">=</span> <span class="n">da</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="n">lon_max</span> <span class="o">=</span> <span class="n">da</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">lon_min</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">180</span> <span class="ow">or</span> <span class="n">lon_max</span> <span class="o">&gt;</span> <span class="mi">180</span><span class="p">:</span>
        <span class="n">da</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">180</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span> <span class="o">-</span> <span class="mi">180</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">lon</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">da</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="download-and-streamline-the-data">
<h3>Download and streamline the data<a class="headerlink" href="#download-and-streamline-the-data" title="Permalink to this heading">#</a></h3>
<p>Embarking on the setup and organization of our data, we’re now venturing into the realms of real-world numbers and figures. Here, patience is a virtue, as the time to request and download the data may vary. The anticipation builds, but typically, this process should take less than 30 minutes.</p>
<section id="noaa-globaltemp">
<h4>NOAA GlobalTemp<a class="headerlink" href="#noaa-globaltemp" title="Permalink to this heading">#</a></h4>
<p><a class="reference external" href="https://www.ncei.noaa.gov/products/land-based-station/noaa-global-temp">NOAA</a> (National Oceanic and Atmospheric Administration) is our next destination. Providing data in different forms, we’ll use the OPeNDAP protocol, turning what could be a complex task into a simple two-liner. A note to remember: the data comes with an additional <code class="docutils literal notranslate"><span class="pre">z</span></code> dimension, but fear not, it only represents one level (surface).</p>
<p>As the NOAA doesn’t offer any land-sea weights for the dataset, we’ll employ the ingenious functionality of <code class="docutils literal notranslate"><span class="pre">regionmask</span></code> to create a suitable land-sea mask for our dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url_to_noaa</span> <span class="o">=</span> <span class="s2">&quot;https://www.ncei.noaa.gov/thredds/dodsC/noaa-global-temp-v5.1/NOAAGlobalTemp_v5.1.0_gridded_s185001_e202306_c20230708T112624.nc&quot;</span>
<span class="n">noaa</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">url_to_noaa</span><span class="p">)</span>
<span class="n">noaa</span> <span class="o">=</span> <span class="n">noaa</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">noaa</span> <span class="o">=</span> <span class="n">streamline_coords</span><span class="p">(</span><span class="n">noaa</span><span class="p">)</span>
<span class="n">noaa</span><span class="p">[</span><span class="s2">&quot;lsm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lsm</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">noaa</span><span class="p">)</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>  <span class="c1"># Create a boolean land-sea mask (1=land, 0=sea)</span>
<span class="n">noaa</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:  (time: 2082, lat: 36, lon: 72)
Coordinates:
  * time     (time) datetime64[ns] 1850-01-01 1850-02-01 ... 2023-06-01
  * lat      (lat) float32 -87.5 -82.5 -77.5 -72.5 -67.5 ... 72.5 77.5 82.5 87.5
  * lon      (lon) float32 -177.5 -172.5 -167.5 -162.5 ... 167.5 172.5 177.5
Data variables:
    anom     (time, lat, lon) float32 ...
    lsm      (lat, lon) bool True True True True ... False False False False
Attributes: (12/66)
    Conventions:                     CF-1.6, ACDD-1.3
    title:                           NOAA Merged Land Ocean Global Surface Te...
    summary:                         NOAAGlobalTemp is a merged land-ocean su...
    institution:                     DOC/NOAA/NESDIS/National Centers for Env...
    id:                               gov.noaa.ncdc:C00934 
    naming_authority:                 gov.noaa.ncei 
    ...                              ...
    time_coverage_duration:          P173Y6M
    references:                      Vose, R. S., et al., 2012: NOAAs merged ...
    climatology:                     Climatology is based on 1971-2000 monthl...
    acknowledgment:                  The NOAA Global Surface Temperature Data...
    date_modified:                   2023-07-08T15:26:25Z
    date_issued:                     2023-07-08T15:26:25Z</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-74f078dd-7253-4147-8128-39daac719727' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-74f078dd-7253-4147-8128-39daac719727' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 2082</li><li><span class='xr-has-index'>lat</span>: 36</li><li><span class='xr-has-index'>lon</span>: 72</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-ffc60ea4-bcde-4764-80a6-adddb6c9cba9' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ffc60ea4-bcde-4764-80a6-adddb6c9cba9' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1850-01-01 ... 2023-06-01</div><input id='attrs-c142090a-e60d-4f3e-8e85-c41f1b1bb017' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c142090a-e60d-4f3e-8e85-c41f1b1bb017' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e9f3e7ae-f869-4743-8715-a6a2ac9c6605' class='xr-var-data-in' type='checkbox'><label for='data-e9f3e7ae-f869-4743-8715-a6a2ac9c6605' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;1850-01-01T00:00:00.000000000&#x27;, &#x27;1850-02-01T00:00:00.000000000&#x27;,
       &#x27;1850-03-01T00:00:00.000000000&#x27;, ..., &#x27;2023-04-01T00:00:00.000000000&#x27;,
       &#x27;2023-05-01T00:00:00.000000000&#x27;, &#x27;2023-06-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-87.5 -82.5 -77.5 ... 82.5 87.5</div><input id='attrs-fd65405b-4d0d-42d6-b0b6-64ef26d8a0c0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fd65405b-4d0d-42d6-b0b6-64ef26d8a0c0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dfa4f1e5-a75d-42c9-84dd-8d59c2e1343b' class='xr-var-data-in' type='checkbox'><label for='data-dfa4f1e5-a75d-42c9-84dd-8d59c2e1343b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>coverage_content_type :</span></dt><dd>coordinate</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>grids :</span></dt><dd>Uniform grid from -87.5 to 87.5 by 5</dd><dt><span>valid_min :</span></dt><dd>-87.5</dd><dt><span>valid_max :</span></dt><dd>87.5</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>_CoordinateAxisType :</span></dt><dd>Lat</dd><dt><span>coordinate_defines :</span></dt><dd>center</dd></dl></div><div class='xr-var-data'><pre>array([-87.5, -82.5, -77.5, -72.5, -67.5, -62.5, -57.5, -52.5, -47.5, -42.5,
       -37.5, -32.5, -27.5, -22.5, -17.5, -12.5,  -7.5,  -2.5,   2.5,   7.5,
        12.5,  17.5,  22.5,  27.5,  32.5,  37.5,  42.5,  47.5,  52.5,  57.5,
        62.5,  67.5,  72.5,  77.5,  82.5,  87.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-177.5 -172.5 ... 172.5 177.5</div><input id='attrs-2d9b5955-7b72-4011-be85-b977e4554dd2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2d9b5955-7b72-4011-be85-b977e4554dd2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8f4c4a6a-d7d9-4a7a-a4d7-8094bbb48ad8' class='xr-var-data-in' type='checkbox'><label for='data-8f4c4a6a-d7d9-4a7a-a4d7-8094bbb48ad8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-177.5, -172.5, -167.5, -162.5, -157.5, -152.5, -147.5, -142.5, -137.5,
       -132.5, -127.5, -122.5, -117.5, -112.5, -107.5, -102.5,  -97.5,  -92.5,
        -87.5,  -82.5,  -77.5,  -72.5,  -67.5,  -62.5,  -57.5,  -52.5,  -47.5,
        -42.5,  -37.5,  -32.5,  -27.5,  -22.5,  -17.5,  -12.5,   -7.5,   -2.5,
          2.5,    7.5,   12.5,   17.5,   22.5,   27.5,   32.5,   37.5,   42.5,
         47.5,   52.5,   57.5,   62.5,   67.5,   72.5,   77.5,   82.5,   87.5,
         92.5,   97.5,  102.5,  107.5,  112.5,  117.5,  122.5,  127.5,  132.5,
        137.5,  142.5,  147.5,  152.5,  157.5,  162.5,  167.5,  172.5,  177.5],
      dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-aae33914-79dc-4e0a-a293-6eec7c3cb037' class='xr-section-summary-in' type='checkbox'  checked><label for='section-aae33914-79dc-4e0a-a293-6eec7c3cb037' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>anom</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-8f0c9199-c416-4770-a316-af9d1fb45e83' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8f0c9199-c416-4770-a316-af9d1fb45e83' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5bf92519-8545-4d7b-9326-98ad2ac09094' class='xr-var-data-in' type='checkbox'><label for='data-5bf92519-8545-4d7b-9326-98ad2ac09094' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Global Temperature Anomalies</dd><dt><span>standard_name :</span></dt><dd>surface_temperature_anomaly</dd><dt><span>coverage_content_type :</span></dt><dd>physicalMeasurement</dd><dt><span>units :</span></dt><dd>degrees C</dd><dt><span>valid_min :</span></dt><dd>-40.0</dd><dt><span>valid_max :</span></dt><dd>40.0</dd></dl></div><div class='xr-var-data'><pre>[5396544 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lsm</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>True True True ... False False</div><input id='attrs-3129f09a-2d17-4986-a537-0624bf1328a4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3129f09a-2d17-4986-a537-0624bf1328a4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1d757a54-250c-46b7-b8e9-301f73790504' class='xr-var-data-in' type='checkbox'><label for='data-1d757a54-250c-46b7-b8e9-301f73790504' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ True,  True,  True, ...,  True,  True,  True],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       ...,
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-af8a7d21-4cdb-4bf9-bab7-9f640f6c58a8' class='xr-section-summary-in' type='checkbox'  ><label for='section-af8a7d21-4cdb-4bf9-bab7-9f640f6c58a8' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-bfe9e8fb-5efc-4ef1-97a1-90bb34369c9a' class='xr-index-data-in' type='checkbox'/><label for='index-bfe9e8fb-5efc-4ef1-97a1-90bb34369c9a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1850-01-01&#x27;, &#x27;1850-02-01&#x27;, &#x27;1850-03-01&#x27;, &#x27;1850-04-01&#x27;,
               &#x27;1850-05-01&#x27;, &#x27;1850-06-01&#x27;, &#x27;1850-07-01&#x27;, &#x27;1850-08-01&#x27;,
               &#x27;1850-09-01&#x27;, &#x27;1850-10-01&#x27;,
               ...
               &#x27;2022-09-01&#x27;, &#x27;2022-10-01&#x27;, &#x27;2022-11-01&#x27;, &#x27;2022-12-01&#x27;,
               &#x27;2023-01-01&#x27;, &#x27;2023-02-01&#x27;, &#x27;2023-03-01&#x27;, &#x27;2023-04-01&#x27;,
               &#x27;2023-05-01&#x27;, &#x27;2023-06-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=2082, freq=&#x27;MS&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-7c538294-5e73-4b38-8a2a-b03cdc355185' class='xr-index-data-in' type='checkbox'/><label for='index-7c538294-5e73-4b38-8a2a-b03cdc355185' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-87.5, -82.5, -77.5, -72.5, -67.5, -62.5, -57.5, -52.5, -47.5, -42.5,
       -37.5, -32.5, -27.5, -22.5, -17.5, -12.5,  -7.5,  -2.5,   2.5,   7.5,
        12.5,  17.5,  22.5,  27.5,  32.5,  37.5,  42.5,  47.5,  52.5,  57.5,
        62.5,  67.5,  72.5,  77.5,  82.5,  87.5],
      dtype=&#x27;float32&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-493265b4-d828-46a8-8921-5c1d883e09e0' class='xr-index-data-in' type='checkbox'/><label for='index-493265b4-d828-46a8-8921-5c1d883e09e0' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-177.5, -172.5, -167.5, -162.5, -157.5, -152.5, -147.5, -142.5, -137.5,
       -132.5, -127.5, -122.5, -117.5, -112.5, -107.5, -102.5,  -97.5,  -92.5,
        -87.5,  -82.5,  -77.5,  -72.5,  -67.5,  -62.5,  -57.5,  -52.5,  -47.5,
        -42.5,  -37.5,  -32.5,  -27.5,  -22.5,  -17.5,  -12.5,   -7.5,   -2.5,
          2.5,    7.5,   12.5,   17.5,   22.5,   27.5,   32.5,   37.5,   42.5,
         47.5,   52.5,   57.5,   62.5,   67.5,   72.5,   77.5,   82.5,   87.5,
         92.5,   97.5,  102.5,  107.5,  112.5,  117.5,  122.5,  127.5,  132.5,
        137.5,  142.5,  147.5,  152.5,  157.5,  162.5,  167.5,  172.5,  177.5],
      dtype=&#x27;float32&#x27;, name=&#x27;lon&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1f0dc411-43e1-4f15-925e-7abc97b8b4e7' class='xr-section-summary-in' type='checkbox'  ><label for='section-1f0dc411-43e1-4f15-925e-7abc97b8b4e7' class='xr-section-summary' >Attributes: <span>(66)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.6, ACDD-1.3</dd><dt><span>title :</span></dt><dd>NOAA Merged Land Ocean Global Surface Temperature Analysis (NOAAGlobalTemp)</dd><dt><span>summary :</span></dt><dd>NOAAGlobalTemp is a merged land-ocean surface temperature analysis, formerly abbreviated as MLOST. The SST dataset is the Extended Reconstructed Sea Surface Temperature (ERSST) and the land surface air temperature dataset is from the Global Historical Climatology Network Monthly (GHCN-M) database.</dd><dt><span>institution :</span></dt><dd>DOC/NOAA/NESDIS/National Centers for Environmental Information(NCEI)</dd><dt><span>id :</span></dt><dd> gov.noaa.ncdc:C00934 </dd><dt><span>naming_authority :</span></dt><dd> gov.noaa.ncei </dd><dt><span>project :</span></dt><dd> NOAAGlobalTemp </dd><dt><span>platform :</span></dt><dd>Ships, moored buoys, surface drifting buoys, Argo floats, and weather stations</dd><dt><span>instrument :</span></dt><dd>Conventional thermometers</dd><dt><span>history :</span></dt><dd>Version 5.1.0, blending ERSST V5 and GHCN-M V4.</dd><dt><span>comment :</span></dt><dd>Merged land ocean surface temperature anomalies.</dd><dt><span>product_version :</span></dt><dd>5.1.0</dd><dt><span>source :</span></dt><dd>NOAAGlobalTemp combines a global sea surface temperature with a global land surface air temperature data</dd><dt><span>ncei_template_version :</span></dt><dd>NCEI_NetCDF_Grid_Template_v2.0</dd><dt><span>Metadata_Conventions :</span></dt><dd>Unidata Dataset Discovery v1.0</dd><dt><span>license :</span></dt><dd>These data are available for use without restriction.</dd><dt><span>creator_name :</span></dt><dd>Boyin Huang, Xungang Yin, Ph.D</dd><dt><span>creator_email :</span></dt><dd>Boyin.Huang@noaa.gov, Xungang.Yin@noaa.gov</dd><dt><span>creator_type :</span></dt><dd>group</dd><dt><span>creator_institution :</span></dt><dd>US DOC/NOAA/NESDIS/National Centers for Environmental Information(NCEI)</dd><dt><span>contributor_name :</span></dt><dd>Huai-min Zhang, Ph.D</dd><dt><span>contributor_role :</span></dt><dd>Chief, NOAA/NESDIS/NCEI/CCOG/OSB Ocean Surface Section</dd><dt><span>publisher_name :</span></dt><dd>NCEI</dd><dt><span>publisher_institution :</span></dt><dd>NCEI</dd><dt><span>publisher_url :</span></dt><dd>https://www.ncdc.noaa.gov/</dd><dt><span>publisher_email :</span></dt><dd>ncei.info@noaa.gov</dd><dt><span>publisher_type :</span></dt><dd>institution</dd><dt><span>keywords :</span></dt><dd>Earth Science &gt; Oceans &gt; Ocean Temperature &gt; Sea Surface Temperature, Earth Science &gt; Atmosphere &gt; Atmospheric Temperature &gt; Surface Temperature &gt; Air Temperature</dd><dt><span>keywords_vocabulary :</span></dt><dd>NASA Global Change Master Directory (GCMD) Science Keywords</dd><dt><span>standard_name_vocabulary :</span></dt><dd>Climate and Forecast (CF) Standard Name Table (Version 46, 25 July 2017)</dd><dt><span>date_created :</span></dt><dd>2023-07-08T15:26:25Z</dd><dt><span>necdf_version_id :</span></dt><dd>4.2.1.1</dd><dt><span>netcdf_creator_name :</span></dt><dd>Yongsheng Zhang, Ph.D</dd><dt><span>netcdf_creator_email :</span></dt><dd>yongsheng.zhang@noaa.gov</dd><dt><span>dataset_citation_product :</span></dt><dd>NOAA Merged Land Ocean Global Surface Temperature Analysis (NOAAGlobalTemp)</dd><dt><span>dataset_citation_version :</span></dt><dd>5.1.0</dd><dt><span>dataset_citation_institution :</span></dt><dd>NOAA/NESDIS/NCEI, Asheville, NC, USA</dd><dt><span>dataset_citation_url :</span></dt><dd>https://doi.org/10.25921/9qth-2p70</dd><dt><span>metadata_link :</span></dt><dd>https://doi.org/10.25921/9qth-2p70</dd><dt><span>cdm_data_type :</span></dt><dd>Grid</dd><dt><span>grid_mapping_name :</span></dt><dd>latitude_longitude</dd><dt><span>processing_level :</span></dt><dd>NOAA Processing Level 4</dd><dt><span>geospatial_lon_min :</span></dt><dd>2.5</dd><dt><span>geospatial_lon_max :</span></dt><dd>357.5</dd><dt><span>geospatial_lon_units :</span></dt><dd>degrees_east</dd><dt><span>geospatial_lon_resolution :</span></dt><dd>5.0 degree</dd><dt><span>geospatial_lat_min :</span></dt><dd>-87.5</dd><dt><span>geospatial_lat_max :</span></dt><dd>87.5</dd><dt><span>geospatial_lat_units :</span></dt><dd>degrees_north</dd><dt><span>geospatial_lat_resolution :</span></dt><dd>5.0 degree</dd><dt><span>geospatial_bounds :</span></dt><dd>POLYGON ((2.5 -87.5, 2.5 87.5, 357.5 87.5, 357.5 -87.5, 2.5 -87.5))</dd><dt><span>geospatial_bounds_crs :</span></dt><dd>EPSG:4326</dd><dt><span>geospatial_vertical_min :</span></dt><dd>0.0</dd><dt><span>geospatial_vertical_max :</span></dt><dd>0.0</dd><dt><span>geospatial_vertical_units :</span></dt><dd>meters</dd><dt><span>geospatial_vertical_resolution :</span></dt><dd>0.f</dd><dt><span>geospatial_vertical_positive :</span></dt><dd>up</dd><dt><span>time_coverage_start :</span></dt><dd>1850-01</dd><dt><span>time_coverage_end :</span></dt><dd>2023-06</dd><dt><span>time_coverage_resolution :</span></dt><dd>P1M</dd><dt><span>time_coverage_duration :</span></dt><dd>P173Y6M</dd><dt><span>references :</span></dt><dd>Vose, R. S., et al., 2012: NOAAs merged land-ocean surface temperature analysis. Bulletin of the American Meteorological Society, 93, 1677-1685. doi: 10.1175/BAMS-D-11-00241.1. Huang, B., Peter W. Thorne, et. al, 2017: Extended Reconstructed Sea Surface Temperature version 5 (ERSSTv5), Upgrades, validations, and intercomparisons. J. Climate, 30, 8179-8205. doi: 10.1175/JCLI-D-16-0836.1</dd><dt><span>climatology :</span></dt><dd>Climatology is based on 1971-2000 monthly climatology</dd><dt><span>acknowledgment :</span></dt><dd>The NOAA Global Surface Temperature Dataset is provided by the NOAA National Centers for Environmental Information(NCEI)</dd><dt><span>date_modified :</span></dt><dd>2023-07-08T15:26:25Z</dd><dt><span>date_issued :</span></dt><dd>2023-07-08T15:26:25Z</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="alert alert-block alert-warning">
<b>Note</b> <br>
    The mask from regionmask is based on <a gref="https://www.naturalearthdata.com/">NaturalEarth</a> shapefiles and is always boolean (consists only of 0s and 1s). In reality, grid cells (especially on the coast) consist of a certain proportion of water and land, which ideally should be reflected. Therefore, it is advisable to use the official land-sea mask of a dataset if possible. In our application, the differences due to this simplification are negligible.</a>
</div></section>
<section id="berkeley-earth">
<h4>Berkeley Earth<a class="headerlink" href="#berkeley-earth" title="Permalink to this heading">#</a></h4>
<p>With the NOAA GlobalTemp data in our hands, we move to download data from Berkeley Earth. This dataset is available as a netCDF file, making it compatible with our process.</p>
<p>First, specify the URL and download the Berkeley Earth data to our designated path.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url_berkeley</span> <span class="o">=</span> <span class="s1">&#39;https://berkeley-earth-temperature.s3.us-west-1.amazonaws.com/Global/Gridded/Land_and_Ocean_LatLong1.nc&#39;</span>
<span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">url_berkeley</span><span class="p">,</span> <span class="n">path_to</span><span class="p">[</span><span class="s1">&#39;berkeley&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Then, open the dataset and call the <code class="docutils literal notranslate"><span class="pre">streamline_coords</span></code> function to structure the coordinates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">berkeley</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">path_to</span><span class="p">[</span><span class="s2">&quot;berkeley&quot;</span><span class="p">])</span>
<span class="n">berkeley</span> <span class="o">=</span> <span class="n">streamline_coords</span><span class="p">(</span><span class="n">berkeley</span><span class="p">)</span>
<span class="n">berkeley</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:      (lon: 360, lat: 180, time: 2079, month_number: 12)
Coordinates:
  * lon          (lon) float32 -179.5 -178.5 -177.5 -176.5 ... 177.5 178.5 179.5
  * lat          (lat) float32 -89.5 -88.5 -87.5 -86.5 ... 86.5 87.5 88.5 89.5
  * time         (time) datetime64[ns] 1850-01-01 1850-02-01 ... 2023-03-01
Dimensions without coordinates: month_number
Data variables:
    land_mask    (lat, lon) float64 ...
    temperature  (time, lat, lon) float32 ...
    climatology  (month_number, lat, lon) float32 ...
Attributes:
    Conventions:           Berkeley Earth Internal Convention (based on CF-1.5)
    title:                 Native Format Berkeley Earth Surface Temperature A...
    history:               20-Apr-2023 07:02:14
    institution:           Berkeley Earth Surface Temperature Project
    land_source_history:   05-Apr-2023 08:20:01
    ocean_source_history:  20-Apr-2023 05:22:16
    comment:               This file contains Berkeley Earth surface temperat...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-ee22565d-39a8-41b0-9b35-69b2aca1c883' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-ee22565d-39a8-41b0-9b35-69b2aca1c883' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lon</span>: 360</li><li><span class='xr-has-index'>lat</span>: 180</li><li><span class='xr-has-index'>time</span>: 2079</li><li><span>month_number</span>: 12</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-c03e306f-895a-45e9-9fff-d2f8c9dd1fb5' class='xr-section-summary-in' type='checkbox'  checked><label for='section-c03e306f-895a-45e9-9fff-d2f8c9dd1fb5' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-179.5 -178.5 ... 178.5 179.5</div><input id='attrs-f51c4fad-6d13-434d-8038-95f49a0079fc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f51c4fad-6d13-434d-8038-95f49a0079fc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4d106e69-bc20-4282-b466-ff2972e93812' class='xr-var-data-in' type='checkbox'><label for='data-4d106e69-bc20-4282-b466-ff2972e93812' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd></dl></div><div class='xr-var-data'><pre>array([-179.5, -178.5, -177.5, ...,  177.5,  178.5,  179.5], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-89.5 -88.5 -87.5 ... 88.5 89.5</div><input id='attrs-874d2466-ea4b-4d2b-83b1-19f275c8781f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-874d2466-ea4b-4d2b-83b1-19f275c8781f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4292f423-105b-4202-a6dd-73153d0c4455' class='xr-var-data-in' type='checkbox'><label for='data-4292f423-105b-4202-a6dd-73153d0c4455' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd></dl></div><div class='xr-var-data'><pre>array([-89.5, -88.5, -87.5, -86.5, -85.5, -84.5, -83.5, -82.5, -81.5, -80.5,
       -79.5, -78.5, -77.5, -76.5, -75.5, -74.5, -73.5, -72.5, -71.5, -70.5,
       -69.5, -68.5, -67.5, -66.5, -65.5, -64.5, -63.5, -62.5, -61.5, -60.5,
       -59.5, -58.5, -57.5, -56.5, -55.5, -54.5, -53.5, -52.5, -51.5, -50.5,
       -49.5, -48.5, -47.5, -46.5, -45.5, -44.5, -43.5, -42.5, -41.5, -40.5,
       -39.5, -38.5, -37.5, -36.5, -35.5, -34.5, -33.5, -32.5, -31.5, -30.5,
       -29.5, -28.5, -27.5, -26.5, -25.5, -24.5, -23.5, -22.5, -21.5, -20.5,
       -19.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5,
        -9.5,  -8.5,  -7.5,  -6.5,  -5.5,  -4.5,  -3.5,  -2.5,  -1.5,  -0.5,
         0.5,   1.5,   2.5,   3.5,   4.5,   5.5,   6.5,   7.5,   8.5,   9.5,
        10.5,  11.5,  12.5,  13.5,  14.5,  15.5,  16.5,  17.5,  18.5,  19.5,
        20.5,  21.5,  22.5,  23.5,  24.5,  25.5,  26.5,  27.5,  28.5,  29.5,
        30.5,  31.5,  32.5,  33.5,  34.5,  35.5,  36.5,  37.5,  38.5,  39.5,
        40.5,  41.5,  42.5,  43.5,  44.5,  45.5,  46.5,  47.5,  48.5,  49.5,
        50.5,  51.5,  52.5,  53.5,  54.5,  55.5,  56.5,  57.5,  58.5,  59.5,
        60.5,  61.5,  62.5,  63.5,  64.5,  65.5,  66.5,  67.5,  68.5,  69.5,
        70.5,  71.5,  72.5,  73.5,  74.5,  75.5,  76.5,  77.5,  78.5,  79.5,
        80.5,  81.5,  82.5,  83.5,  84.5,  85.5,  86.5,  87.5,  88.5,  89.5],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1850-01-01 ... 2023-03-01</div><input id='attrs-65a772a2-a3a4-4763-94c3-2baa7d0e87e2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-65a772a2-a3a4-4763-94c3-2baa7d0e87e2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8971bddd-86b3-48de-a4bf-3e1316c2e3a3' class='xr-var-data-in' type='checkbox'><label for='data-8971bddd-86b3-48de-a4bf-3e1316c2e3a3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;1850-01-01T00:00:00.000000000&#x27;, &#x27;1850-02-01T00:00:00.000000000&#x27;,
       &#x27;1850-03-01T00:00:00.000000000&#x27;, ..., &#x27;2023-01-01T00:00:00.000000000&#x27;,
       &#x27;2023-02-01T00:00:00.000000000&#x27;, &#x27;2023-03-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d67250d7-8ff6-41f6-b748-ca5fa1ca45a6' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d67250d7-8ff6-41f6-b748-ca5fa1ca45a6' class='xr-section-summary' >Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>land_mask</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-ec21e447-6e8b-4d1f-aea6-395d9608c148' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ec21e447-6e8b-4d1f-aea6-395d9608c148' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-71705098-93d7-43cc-960a-8aaee788a8b0' class='xr-var-data-in' type='checkbox'><label for='data-71705098-93d7-43cc-960a-8aaee788a8b0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>none</dd><dt><span>standard_name :</span></dt><dd>land_mask</dd><dt><span>long_name :</span></dt><dd>Land Mask</dd><dt><span>valid_min :</span></dt><dd>0.0</dd><dt><span>valid_max :</span></dt><dd>1.0</dd></dl></div><div class='xr-var-data'><pre>[64800 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>temperature</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-cac6ffca-713d-4943-b8b4-1abdb7a5ed07' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cac6ffca-713d-4943-b8b4-1abdb7a5ed07' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4ccfabf5-b7e7-4229-b527-4874a2f3827a' class='xr-var-data-in' type='checkbox'><label for='data-4ccfabf5-b7e7-4229-b527-4874a2f3827a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degree C</dd><dt><span>standard_name :</span></dt><dd>surface_temperature_anomaly</dd><dt><span>long_name :</span></dt><dd>Air Surface Temperature Anomaly</dd><dt><span>valid_min :</span></dt><dd>-20.139212068541624</dd><dt><span>valid_max :</span></dt><dd>25.70646898051551</dd></dl></div><div class='xr-var-data'><pre>[134719200 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>climatology</span></div><div class='xr-var-dims'>(month_number, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-491ef487-ac60-4324-9e0f-f8f8e0391778' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-491ef487-ac60-4324-9e0f-f8f8e0391778' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0032723e-a556-4529-9351-da45f7d9b706' class='xr-var-data-in' type='checkbox'><label for='data-0032723e-a556-4529-9351-da45f7d9b706' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degree C</dd><dt><span>standard_name :</span></dt><dd>surface_temperature_climatology</dd><dt><span>long_name :</span></dt><dd>Air Surface Temperature Climatology (Jan 1951 - Dec 1980)</dd><dt><span>valid_min :</span></dt><dd>-69.07067576592691</dd><dt><span>valid_max :</span></dt><dd>38.231822261999675</dd></dl></div><div class='xr-var-data'><pre>[777600 values with dtype=float32]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-bb5db1ee-5a8d-4708-92d7-f92b9ed324c0' class='xr-section-summary-in' type='checkbox'  ><label for='section-bb5db1ee-5a8d-4708-92d7-f92b9ed324c0' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-156a6265-c178-4553-aa5d-52039202c230' class='xr-index-data-in' type='checkbox'/><label for='index-156a6265-c178-4553-aa5d-52039202c230' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-179.5, -178.5, -177.5, -176.5, -175.5, -174.5, -173.5, -172.5, -171.5,
       -170.5,
       ...
        170.5,  171.5,  172.5,  173.5,  174.5,  175.5,  176.5,  177.5,  178.5,
        179.5],
      dtype=&#x27;float32&#x27;, name=&#x27;lon&#x27;, length=360))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-b1d6ceaf-318e-4fc1-b4cb-300a916d7473' class='xr-index-data-in' type='checkbox'/><label for='index-b1d6ceaf-318e-4fc1-b4cb-300a916d7473' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-89.5, -88.5, -87.5, -86.5, -85.5, -84.5, -83.5, -82.5, -81.5, -80.5,
       ...
        80.5,  81.5,  82.5,  83.5,  84.5,  85.5,  86.5,  87.5,  88.5,  89.5],
      dtype=&#x27;float32&#x27;, name=&#x27;lat&#x27;, length=180))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-fc15e63c-ecba-46a0-a6aa-3ceb6fe196a9' class='xr-index-data-in' type='checkbox'/><label for='index-fc15e63c-ecba-46a0-a6aa-3ceb6fe196a9' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1850-01-01&#x27;, &#x27;1850-02-01&#x27;, &#x27;1850-03-01&#x27;, &#x27;1850-04-01&#x27;,
               &#x27;1850-05-01&#x27;, &#x27;1850-06-01&#x27;, &#x27;1850-07-01&#x27;, &#x27;1850-08-01&#x27;,
               &#x27;1850-09-01&#x27;, &#x27;1850-10-01&#x27;,
               ...
               &#x27;2022-06-01&#x27;, &#x27;2022-07-01&#x27;, &#x27;2022-08-01&#x27;, &#x27;2022-09-01&#x27;,
               &#x27;2022-10-01&#x27;, &#x27;2022-11-01&#x27;, &#x27;2022-12-01&#x27;, &#x27;2023-01-01&#x27;,
               &#x27;2023-02-01&#x27;, &#x27;2023-03-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=2079, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-2ce6d50f-26d5-4c9f-b872-a68db12ec8f1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-2ce6d50f-26d5-4c9f-b872-a68db12ec8f1' class='xr-section-summary' >Attributes: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>Berkeley Earth Internal Convention (based on CF-1.5)</dd><dt><span>title :</span></dt><dd>Native Format Berkeley Earth Surface Temperature Anomaly Field</dd><dt><span>history :</span></dt><dd>20-Apr-2023 07:02:14</dd><dt><span>institution :</span></dt><dd>Berkeley Earth Surface Temperature Project</dd><dt><span>land_source_history :</span></dt><dd>05-Apr-2023 08:20:01</dd><dt><span>ocean_source_history :</span></dt><dd>20-Apr-2023 05:22:16</dd><dt><span>comment :</span></dt><dd>This file contains Berkeley Earth surface temperature anomaly field in our native equal-area format.</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="alert alert-block alert-info">
<b>Note</b> <br>
    Berkeley Earth data is also available in the <a href="https://cds.climate.copernicus.eu/cdsapp#!/dataset/insitu-gridded-observations-global-and-regional?tab=overview">Climate Data Store (CDS)</a>, but with ocean values masked. If you need land-only averages, the version in CDS can be used. However, note that the CDS does not provide a land-sea mask.
</div>
</section>
<section id="gistemp">
<h4>GISTEMP<a class="headerlink" href="#gistemp" title="Permalink to this heading">#</a></h4>
<p>As our climate exploration continues, we now turn to <a class="reference external" href="https://data.giss.nasa.gov/gistemp/">GISTEMP</a> (Goddard Institute for Space Studies Surface Temperature Analysis). Here, we will handle two different versions of the data: the 250km smoothing version and the 1200km version. The former reveals detailed patterns, while the latter offers a smoother view and greater spatial coverage. Following the approach of <a class="reference external" href="https://rmets.onlinelibrary.wiley.com/doi/full/10.1002/qj.2949">Simmons et al. (2016)</a>, we’ll use the 250km version as our foundation and fill in missing values from the 1200km version.</p>
<ol class="arabic simple">
<li><p><strong>Downloading the GISTEMP Data and land-sea mask</strong></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url_gistemp_1200km</span> <span class="o">=</span> <span class="s1">&#39;https://data.giss.nasa.gov/pub/gistemp/gistemp1200_GHCNv4_ERSSTv5.nc.gz&#39;</span>
<span class="n">url_gistemp_250km</span> <span class="o">=</span> <span class="s1">&#39;https://data.giss.nasa.gov/pub/gistemp/gistemp250_GHCNv4.nc.gz&#39;</span>
<span class="n">url_gistemp_land_sea_mask</span> <span class="o">=</span> <span class="s1">&#39;https://data.giss.nasa.gov/pub/gistemp/landmask.2degx2deg.txt&#39;</span>

<span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">url_gistemp_1200km</span><span class="p">,</span> <span class="s1">&#39;data/gistemp/temperature_gistemp_1200km.gz&#39;</span><span class="p">)</span>
<span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">url_gistemp_250km</span><span class="p">,</span> <span class="s1">&#39;data/gistemp/temperature_gistemp_250km.gz&#39;</span><span class="p">)</span>
<span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">url_gistemp_land_sea_mask</span><span class="p">,</span> <span class="s1">&#39;data/gistemp/temperature_gistemp_land_sea_mask.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple" start="2">
<li><p><strong>Loading and Combining the Datasets</strong></p></li>
</ol>
<p>Open both versions of the dataset, and combine them, replacing missing values from the 250km version with the 1200km version.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s2">&quot;data/gistemp/temperature_gistemp_1200km.gz&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">gistemp_1200</span><span class="p">:</span>
    <span class="n">gistemp_1200</span> <span class="o">=</span> <span class="n">gistemp_1200</span><span class="p">[</span><span class="s2">&quot;tempanomaly&quot;</span><span class="p">]</span>
<span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s2">&quot;data/gistemp/temperature_gistemp_250km.gz&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">gistemp_250</span><span class="p">:</span>
    <span class="n">gistemp_250</span> <span class="o">=</span> <span class="n">gistemp_250</span><span class="p">[</span><span class="s2">&quot;tempanomaly&quot;</span><span class="p">]</span>
<span class="n">gistemp</span> <span class="o">=</span> <span class="n">gistemp_250</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">gistemp_250</span><span class="o">.</span><span class="n">notnull</span><span class="p">(),</span> <span class="n">other</span><span class="o">=</span><span class="n">gistemp_1200</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple" start="3">
<li><p><strong>Downloading the Land-Sea Mask and Streamlining Coordinates</strong></p></li>
</ol>
<p>Get the land-sea mask and streamline the coordinates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gistemp_lsm</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;data/gistemp/temperature_gistemp_land_sea_mask.txt&quot;</span><span class="p">,</span>
    <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;\s+&quot;</span><span class="p">,</span>
    <span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;mask&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">gistemp_lsm</span> <span class="o">=</span> <span class="n">gistemp_lsm</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">])</span>
<span class="n">gistemp_lsm</span> <span class="o">=</span> <span class="n">gistemp_lsm</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">()</span>
<span class="n">gistemp</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">gistemp</span><span class="p">,</span> <span class="n">gistemp_lsm</span><span class="p">[</span><span class="s2">&quot;mask&quot;</span><span class="p">]])</span>
<span class="n">gistemp</span> <span class="o">=</span> <span class="n">streamline_coords</span><span class="p">(</span><span class="n">gistemp</span><span class="p">)</span>
<span class="n">gistemp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:      (lat: 90, lon: 180, time: 1722)
Coordinates:
  * lat          (lat) float32 -89.0 -87.0 -85.0 -83.0 ... 83.0 85.0 87.0 89.0
  * lon          (lon) float32 -179.0 -177.0 -175.0 -173.0 ... 175.0 177.0 179.0
  * time         (time) datetime64[ns] 1880-01-01 1880-02-01 ... 2023-06-01
Data variables:
    tempanomaly  (time, lat, lon) float32 nan nan nan nan ... 1.15 1.15 1.15
    mask         (lat, lon) float64 1.0 1.0 1.0 1.0 1.0 ... 0.0 0.0 0.0 0.0 0.0
Attributes:
    long_name:     Surface temperature anomaly
    units:         K
    cell_methods:  time: mean</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-5fe91c22-66ff-4c7d-9883-67d83b9b9e8e' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-5fe91c22-66ff-4c7d-9883-67d83b9b9e8e' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 90</li><li><span class='xr-has-index'>lon</span>: 180</li><li><span class='xr-has-index'>time</span>: 1722</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-c7ba9be9-00e8-49ac-9f68-19a77ebac969' class='xr-section-summary-in' type='checkbox'  checked><label for='section-c7ba9be9-00e8-49ac-9f68-19a77ebac969' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-89.0 -87.0 -85.0 ... 87.0 89.0</div><input id='attrs-6a7e9132-434b-45d3-b20f-757ab05c0e95' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6a7e9132-434b-45d3-b20f-757ab05c0e95' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-87ecd652-5385-49bd-9dbd-6c384c8f27db' class='xr-var-data-in' type='checkbox'><label for='data-87ecd652-5385-49bd-9dbd-6c384c8f27db' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([-89., -87., -85., -83., -81., -79., -77., -75., -73., -71., -69., -67.,
       -65., -63., -61., -59., -57., -55., -53., -51., -49., -47., -45., -43.,
       -41., -39., -37., -35., -33., -31., -29., -27., -25., -23., -21., -19.,
       -17., -15., -13., -11.,  -9.,  -7.,  -5.,  -3.,  -1.,   1.,   3.,   5.,
         7.,   9.,  11.,  13.,  15.,  17.,  19.,  21.,  23.,  25.,  27.,  29.,
        31.,  33.,  35.,  37.,  39.,  41.,  43.,  45.,  47.,  49.,  51.,  53.,
        55.,  57.,  59.,  61.,  63.,  65.,  67.,  69.,  71.,  73.,  75.,  77.,
        79.,  81.,  83.,  85.,  87.,  89.], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-179.0 -177.0 ... 177.0 179.0</div><input id='attrs-a1d7adf4-9328-4fe2-ba82-759c077a392c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a1d7adf4-9328-4fe2-ba82-759c077a392c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2676f6c0-bd8f-4143-9120-179b79204221' class='xr-var-data-in' type='checkbox'><label for='data-2676f6c0-bd8f-4143-9120-179b79204221' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([-179., -177., -175., -173., -171., -169., -167., -165., -163., -161.,
       -159., -157., -155., -153., -151., -149., -147., -145., -143., -141.,
       -139., -137., -135., -133., -131., -129., -127., -125., -123., -121.,
       -119., -117., -115., -113., -111., -109., -107., -105., -103., -101.,
        -99.,  -97.,  -95.,  -93.,  -91.,  -89.,  -87.,  -85.,  -83.,  -81.,
        -79.,  -77.,  -75.,  -73.,  -71.,  -69.,  -67.,  -65.,  -63.,  -61.,
        -59.,  -57.,  -55.,  -53.,  -51.,  -49.,  -47.,  -45.,  -43.,  -41.,
        -39.,  -37.,  -35.,  -33.,  -31.,  -29.,  -27.,  -25.,  -23.,  -21.,
        -19.,  -17.,  -15.,  -13.,  -11.,   -9.,   -7.,   -5.,   -3.,   -1.,
          1.,    3.,    5.,    7.,    9.,   11.,   13.,   15.,   17.,   19.,
         21.,   23.,   25.,   27.,   29.,   31.,   33.,   35.,   37.,   39.,
         41.,   43.,   45.,   47.,   49.,   51.,   53.,   55.,   57.,   59.,
         61.,   63.,   65.,   67.,   69.,   71.,   73.,   75.,   77.,   79.,
         81.,   83.,   85.,   87.,   89.,   91.,   93.,   95.,   97.,   99.,
        101.,  103.,  105.,  107.,  109.,  111.,  113.,  115.,  117.,  119.,
        121.,  123.,  125.,  127.,  129.,  131.,  133.,  135.,  137.,  139.,
        141.,  143.,  145.,  147.,  149.,  151.,  153.,  155.,  157.,  159.,
        161.,  163.,  165.,  167.,  169.,  171.,  173.,  175.,  177.,  179.],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1880-01-01 ... 2023-06-01</div><input id='attrs-de09ca02-430d-4c5e-88fa-573933484323' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-de09ca02-430d-4c5e-88fa-573933484323' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-865ed3e3-2611-4394-ab08-fb580f7f9887' class='xr-var-data-in' type='checkbox'><label for='data-865ed3e3-2611-4394-ab08-fb580f7f9887' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;1880-01-01T00:00:00.000000000&#x27;, &#x27;1880-02-01T00:00:00.000000000&#x27;,
       &#x27;1880-03-01T00:00:00.000000000&#x27;, ..., &#x27;2023-04-01T00:00:00.000000000&#x27;,
       &#x27;2023-05-01T00:00:00.000000000&#x27;, &#x27;2023-06-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4809be20-dcc1-43cc-bcad-cd9b6d381d89' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4809be20-dcc1-43cc-bcad-cd9b6d381d89' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>tempanomaly</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... 1.15 1.15 1.15</div><input id='attrs-cb15b9a4-3123-4e1a-a958-71d97b5abdb5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cb15b9a4-3123-4e1a-a958-71d97b5abdb5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c893c32e-6d81-4f59-8c6b-e71c49051653' class='xr-var-data-in' type='checkbox'><label for='data-c893c32e-6d81-4f59-8c6b-e71c49051653' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Surface temperature anomaly</dd><dt><span>units :</span></dt><dd>K</dd><dt><span>cell_methods :</span></dt><dd>time: mean</dd></dl></div><div class='xr-var-data'><pre>array([[[  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        ...,
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan]],

       [[  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        ...,
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan]],

       [[  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        [  nan,   nan,   nan, ...,   nan,   nan,   nan],
        ...,
...
        ...,
        [ 3.  ,  3.  ,  3.  , ...,  3.  ,  3.  ,  3.  ],
        [ 3.  ,  3.  ,  3.  , ...,  3.  ,  3.  ,  3.  ],
        [ 3.  ,  3.  ,  3.  , ...,  3.  ,  3.  ,  3.  ]],

       [[-0.53, -0.53, -0.53, ..., -0.53, -0.53, -0.53],
        [-0.53, -0.53, -0.53, ..., -0.53, -0.53, -0.53],
        [-0.53, -0.53, -0.53, ..., -0.53, -0.53, -0.53],
        ...,
        [ 0.83,  0.83,  0.83, ...,  0.83,  0.83,  0.83],
        [ 0.83,  0.83,  0.83, ...,  0.83,  0.83,  0.83],
        [ 0.83,  0.83,  0.83, ...,  0.83,  0.83,  0.83]],

       [[ 1.05,  1.05,  1.05, ...,  1.05,  1.05,  1.05],
        [ 1.05,  1.05,  1.05, ...,  1.05,  1.05,  1.05],
        [ 1.05,  1.05,  1.05, ...,  1.05,  1.05,  1.05],
        ...,
        [ 1.15,  1.15,  1.15, ...,  1.15,  1.15,  1.15],
        [ 1.15,  1.15,  1.15, ...,  1.15,  1.15,  1.15],
        [ 1.15,  1.15,  1.15, ...,  1.15,  1.15,  1.15]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>mask</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0 1.0 1.0 1.0 ... 0.0 0.0 0.0 0.0</div><input id='attrs-a7810ca4-8488-409e-a612-1b1b14a0ab98' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a7810ca4-8488-409e-a612-1b1b14a0ab98' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c49b3669-980f-4320-8cff-64d7d939d7b7' class='xr-var-data-in' type='checkbox'><label for='data-c49b3669-980f-4320-8cff-64d7d939d7b7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[1., 1., 1., ..., 1., 1., 1.],
       [1., 1., 1., ..., 1., 1., 1.],
       [1., 1., 1., ..., 1., 1., 1.],
       ...,
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e29c8a76-a072-4dab-948d-0dd6ea6f5b4b' class='xr-section-summary-in' type='checkbox'  ><label for='section-e29c8a76-a072-4dab-948d-0dd6ea6f5b4b' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-eb2f1dec-1510-4380-b8fd-bbe34c62dfaa' class='xr-index-data-in' type='checkbox'/><label for='index-eb2f1dec-1510-4380-b8fd-bbe34c62dfaa' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-89.0, -87.0, -85.0, -83.0, -81.0, -79.0, -77.0, -75.0, -73.0, -71.0,
       -69.0, -67.0, -65.0, -63.0, -61.0, -59.0, -57.0, -55.0, -53.0, -51.0,
       -49.0, -47.0, -45.0, -43.0, -41.0, -39.0, -37.0, -35.0, -33.0, -31.0,
       -29.0, -27.0, -25.0, -23.0, -21.0, -19.0, -17.0, -15.0, -13.0, -11.0,
        -9.0,  -7.0,  -5.0,  -3.0,  -1.0,   1.0,   3.0,   5.0,   7.0,   9.0,
        11.0,  13.0,  15.0,  17.0,  19.0,  21.0,  23.0,  25.0,  27.0,  29.0,
        31.0,  33.0,  35.0,  37.0,  39.0,  41.0,  43.0,  45.0,  47.0,  49.0,
        51.0,  53.0,  55.0,  57.0,  59.0,  61.0,  63.0,  65.0,  67.0,  69.0,
        71.0,  73.0,  75.0,  77.0,  79.0,  81.0,  83.0,  85.0,  87.0,  89.0],
      dtype=&#x27;float32&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-20312065-a512-43df-abc4-e83fdebea645' class='xr-index-data-in' type='checkbox'/><label for='index-20312065-a512-43df-abc4-e83fdebea645' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-179.0, -177.0, -175.0, -173.0, -171.0, -169.0, -167.0, -165.0, -163.0,
       -161.0,
       ...
        161.0,  163.0,  165.0,  167.0,  169.0,  171.0,  173.0,  175.0,  177.0,
        179.0],
      dtype=&#x27;float32&#x27;, name=&#x27;lon&#x27;, length=180))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-83d9eb9f-be84-4d4a-b365-429ec55b6960' class='xr-index-data-in' type='checkbox'/><label for='index-83d9eb9f-be84-4d4a-b365-429ec55b6960' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1880-01-01&#x27;, &#x27;1880-02-01&#x27;, &#x27;1880-03-01&#x27;, &#x27;1880-04-01&#x27;,
               &#x27;1880-05-01&#x27;, &#x27;1880-06-01&#x27;, &#x27;1880-07-01&#x27;, &#x27;1880-08-01&#x27;,
               &#x27;1880-09-01&#x27;, &#x27;1880-10-01&#x27;,
               ...
               &#x27;2022-09-01&#x27;, &#x27;2022-10-01&#x27;, &#x27;2022-11-01&#x27;, &#x27;2022-12-01&#x27;,
               &#x27;2023-01-01&#x27;, &#x27;2023-02-01&#x27;, &#x27;2023-03-01&#x27;, &#x27;2023-04-01&#x27;,
               &#x27;2023-05-01&#x27;, &#x27;2023-06-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=1722, freq=&#x27;MS&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-14bb3f40-a4f9-419d-8494-be3bd766f6fd' class='xr-section-summary-in' type='checkbox'  checked><label for='section-14bb3f40-a4f9-419d-8494-be3bd766f6fd' class='xr-section-summary' >Attributes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Surface temperature anomaly</dd><dt><span>units :</span></dt><dd>K</dd><dt><span>cell_methods :</span></dt><dd>time: mean</dd></dl></div></li></ul></div></div></div></div>
</div>
<ol class="arabic simple" start="4">
<li><p><strong>Inspecting the Differences</strong></p></li>
</ol>
<p>Plot the differences between the 250km and 1200km versions to visually understand the nuances.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">))</span>
<span class="n">gistemp_250</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">gistemp_1200</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;GISTEMP 250 km&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;GISTEMP 1200 km&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.0, 1.0, &#39;GISTEMP 1200 km&#39;)
</pre></div>
</div>
<img alt="_images/f22eebb52eee94c1ce201d25b2e385e8448d8b038b2fe2f16e8713cb4c228c37.png" src="_images/f22eebb52eee94c1ce201d25b2e385e8448d8b038b2fe2f16e8713cb4c228c37.png" />
</div>
</div>
</section>
<section id="hadcrut5">
<h4>HadCRUT5<a class="headerlink" href="#hadcrut5" title="Permalink to this heading">#</a></h4>
<p>The <a class="reference external" href="https://www.metoffice.gov.uk/hadobs/hadcrut5/data/current/download.html">HadCRUT5</a> dataset provided by the Met Office allows us to examine global climate anomalies and uncertainties. It includes:</p>
<ul class="simple">
<li><p>A gridded (mean) version</p></li>
<li><p>A land-sea mask</p></li>
<li><p>Individual ensemble members, which helps to understand model uncertainties.</p></li>
</ul>
<ol class="arabic simple">
<li><p><strong>Download the Data</strong></p></li>
</ol>
<p>On the website of HadCRUT5, you’ll find two main versions:</p>
<ol class="arabic simple">
<li><p>HadCRUT5 analysis time series</p></li>
<li><p>HadCRUT5 analysis gridded data</p></li>
</ol>
<p>Since we’re interested in computing the time series ourselves in order to adapt them to our region of interest, we choose the gridded data. Let’s copy the corresponding URLs and download the data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url_hadcrut</span> <span class="o">=</span> <span class="s1">&#39;https://www.metoffice.gov.uk/hadobs/hadcrut5/data/current/analysis/HadCRUT.5.0.1.0.analysis.anomalies.ensemble_mean.nc&#39;</span>
<span class="n">url_hadcrut_weights</span> <span class="o">=</span> <span class="s1">&#39;https://www.metoffice.gov.uk/hadobs/hadcrut5/data/current/analysis/HadCRUT.5.0.1.0.analysis.weights.nc&#39;</span>
<span class="n">url_hadcrut_ens_members</span> <span class="o">=</span> <span class="s1">&#39;https://www.metoffice.gov.uk/hadobs/hadcrut5/data/current/analysis/HadCRUT.5.0.1.0.analysis.anomalies.1_to_10_netcdf.zip&#39;</span>
<span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">url_hadcrut</span><span class="p">,</span> <span class="n">path_to</span><span class="p">[</span><span class="s1">&#39;hadcrut&#39;</span><span class="p">])</span>
<span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">url_hadcrut_weights</span><span class="p">,</span> <span class="n">path_to</span><span class="p">[</span><span class="s1">&#39;hadcrut_lsm&#39;</span><span class="p">])</span>
<span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">url_hadcrut_ens_members</span><span class="p">,</span> <span class="n">path_to</span><span class="p">[</span><span class="s1">&#39;hadcrut_members&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple" start="2">
<li><p><strong>Unzip the Ensemble Members</strong></p></li>
</ol>
<p>We’ll need to extract the downloaded files:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="s1">&#39;data/hadcrut/temperature_hadcrut_ensemble_members.zip&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">z</span><span class="p">:</span>
    <span class="n">z</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="s1">&#39;data/hadcrut/&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple" start="3">
<li><p><strong>Load and Organize the Data</strong></p></li>
</ol>
<p>Load the datasets and streamline them for further analysis:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">path_to</span><span class="p">[</span><span class="s2">&quot;hadcrut&quot;</span><span class="p">])</span> <span class="k">as</span> <span class="n">hadcrut</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">path_to</span><span class="p">[</span><span class="s2">&quot;hadcrut_lsm&quot;</span><span class="p">])</span> <span class="k">as</span> <span class="n">hadcrut_weights</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="n">hadcrut_members</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="s2">&quot;data/hadcrut/*analysis*.nc&quot;</span><span class="p">,</span> <span class="n">combine</span><span class="o">=</span><span class="s2">&quot;nested&quot;</span><span class="p">,</span> <span class="n">concat_dim</span><span class="o">=</span><span class="s2">&quot;realization&quot;</span><span class="p">)</span>
<span class="n">hadcrut_members</span> <span class="o">=</span> <span class="n">hadcrut_members</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>  <span class="c1"># load members into memory</span>
<span class="n">hadcrut</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="n">hadcrut</span><span class="p">[</span><span class="s2">&quot;tas_mean&quot;</span><span class="p">],</span>
        <span class="s2">&quot;weights&quot;</span><span class="p">:</span> <span class="n">hadcrut_weights</span><span class="p">[</span><span class="s2">&quot;weights&quot;</span><span class="p">],</span>
        <span class="s2">&quot;ensemble&quot;</span><span class="p">:</span> <span class="n">hadcrut_members</span><span class="p">[</span><span class="s2">&quot;tas&quot;</span><span class="p">],</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">hadcrut</span> <span class="o">=</span> <span class="n">streamline_coords</span><span class="p">(</span><span class="n">hadcrut</span><span class="p">)</span>
<span class="n">hadcrut</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:      (time: 2082, lat: 36, lon: 72, realization: 10)
Coordinates:
  * time         (time) datetime64[ns] 1850-01-01 1850-02-01 ... 2023-06-01
  * lat          (lat) float64 -87.5 -82.5 -77.5 -72.5 ... 72.5 77.5 82.5 87.5
  * lon          (lon) float64 -177.5 -172.5 -167.5 -162.5 ... 167.5 172.5 177.5
  * realization  (realization) int64 1 10 2 3 4 5 6 7 8 9
Data variables:
    mean         (time, lat, lon) float64 ...
    weights      (time, lat, lon) float64 ...
    ensemble     (realization, time, lat, lon) float64 nan nan ... 0.3561 0.3569</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-30978939-cef8-4fc4-92de-5181276a7fe7' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-30978939-cef8-4fc4-92de-5181276a7fe7' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 2082</li><li><span class='xr-has-index'>lat</span>: 36</li><li><span class='xr-has-index'>lon</span>: 72</li><li><span class='xr-has-index'>realization</span>: 10</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-fd01479b-36d9-4c21-aa4f-8f8b35ba3a80' class='xr-section-summary-in' type='checkbox'  checked><label for='section-fd01479b-36d9-4c21-aa4f-8f8b35ba3a80' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1850-01-01 ... 2023-06-01</div><input id='attrs-da355ba2-3a01-475f-be8a-a528a164d08e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-da355ba2-3a01-475f-be8a-a528a164d08e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-534b8989-43b3-4f06-8edd-ccfcb6c800b6' class='xr-var-data-in' type='checkbox'><label for='data-534b8989-43b3-4f06-8edd-ccfcb6c800b6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;1850-01-01T00:00:00.000000000&#x27;, &#x27;1850-02-01T00:00:00.000000000&#x27;,
       &#x27;1850-03-01T00:00:00.000000000&#x27;, ..., &#x27;2023-04-01T00:00:00.000000000&#x27;,
       &#x27;2023-05-01T00:00:00.000000000&#x27;, &#x27;2023-06-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-87.5 -82.5 -77.5 ... 82.5 87.5</div><input id='attrs-06791aa7-5c46-4d02-8ea0-1648031293fc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-06791aa7-5c46-4d02-8ea0-1648031293fc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-61481944-c252-4f9d-87ed-96626da6abd4' class='xr-var-data-in' type='checkbox'><label for='data-61481944-c252-4f9d-87ed-96626da6abd4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Y</dd><dt><span>bounds :</span></dt><dd>latitude_bnds</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([-87.5, -82.5, -77.5, -72.5, -67.5, -62.5, -57.5, -52.5, -47.5, -42.5,
       -37.5, -32.5, -27.5, -22.5, -17.5, -12.5,  -7.5,  -2.5,   2.5,   7.5,
        12.5,  17.5,  22.5,  27.5,  32.5,  37.5,  42.5,  47.5,  52.5,  57.5,
        62.5,  67.5,  72.5,  77.5,  82.5,  87.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-177.5 -172.5 ... 172.5 177.5</div><input id='attrs-ce3ece52-3ff0-45e4-9ad0-71af28183c23' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ce3ece52-3ff0-45e4-9ad0-71af28183c23' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-22d6eb58-5e07-48f1-9d57-70f6ac619514' class='xr-var-data-in' type='checkbox'><label for='data-22d6eb58-5e07-48f1-9d57-70f6ac619514' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>X</dd><dt><span>bounds :</span></dt><dd>longitude_bnds</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-177.5, -172.5, -167.5, -162.5, -157.5, -152.5, -147.5, -142.5, -137.5,
       -132.5, -127.5, -122.5, -117.5, -112.5, -107.5, -102.5,  -97.5,  -92.5,
        -87.5,  -82.5,  -77.5,  -72.5,  -67.5,  -62.5,  -57.5,  -52.5,  -47.5,
        -42.5,  -37.5,  -32.5,  -27.5,  -22.5,  -17.5,  -12.5,   -7.5,   -2.5,
          2.5,    7.5,   12.5,   17.5,   22.5,   27.5,   32.5,   37.5,   42.5,
         47.5,   52.5,   57.5,   62.5,   67.5,   72.5,   77.5,   82.5,   87.5,
         92.5,   97.5,  102.5,  107.5,  112.5,  117.5,  122.5,  127.5,  132.5,
        137.5,  142.5,  147.5,  152.5,  157.5,  162.5,  167.5,  172.5,  177.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>realization</span></div><div class='xr-var-dims'>(realization)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 10 2 3 4 5 6 7 8 9</div><input id='attrs-a31b430b-6206-4573-a9db-f42c428cd398' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a31b430b-6206-4573-a9db-f42c428cd398' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fc13649e-d040-41dd-bb87-21bfdeee5bfa' class='xr-var-data-in' type='checkbox'><label for='data-fc13649e-d040-41dd-bb87-21bfdeee5bfa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>1</dd><dt><span>standard_name :</span></dt><dd>realization</dd></dl></div><div class='xr-var-data'><pre>array([ 1, 10,  2,  3,  4,  5,  6,  7,  8,  9])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-0b958148-e57d-45c9-a1e4-d80dbc47ed06' class='xr-section-summary-in' type='checkbox'  checked><label for='section-0b958148-e57d-45c9-a1e4-d80dbc47ed06' class='xr-section-summary' >Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>mean</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-a61e6ad7-77c1-415d-a392-c60d90848422' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a61e6ad7-77c1-415d-a392-c60d90848422' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e2371f49-1b00-46a5-98db-5caf2d32461a' class='xr-var-data-in' type='checkbox'><label for='data-e2371f49-1b00-46a5-98db-5caf2d32461a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>blended air_temperature_anomaly over land with sea_water_temperature_anomaly</dd><dt><span>units :</span></dt><dd>K</dd><dt><span>cell_methods :</span></dt><dd>area: mean (interval: 5.0 degrees_north 5.0 degrees_east) time: mean (interval: 1 month) realization: mean</dd></dl></div><div class='xr-var-data'><pre>[5396544 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>weights</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-065c1cba-4eba-4664-a63b-46e58e3bdcf4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-065c1cba-4eba-4664-a63b-46e58e3bdcf4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f7b5df14-9e17-4ae2-9de4-f99ea4cbae2d' class='xr-var-data-in' type='checkbox'><label for='data-f7b5df14-9e17-4ae2-9de4-f99ea4cbae2d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>fractional weight for land data in blending with marine observations</dd><dt><span>units :</span></dt><dd>1</dd></dl></div><div class='xr-var-data'><pre>[5396544 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ensemble</span></div><div class='xr-var-dims'>(realization, time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan ... 0.3561 0.3569</div><input id='attrs-35631e13-1414-466f-897c-3646e1f32859' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-35631e13-1414-466f-897c-3646e1f32859' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8a43c61f-5f25-4830-b489-46b321756281' class='xr-var-data-in' type='checkbox'><label for='data-8a43c61f-5f25-4830-b489-46b321756281' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>blended air_temperature_anomaly over land with sea_water_temperature_anomaly</dd><dt><span>units :</span></dt><dd>K</dd><dt><span>cell_methods :</span></dt><dd>area: mean (interval: 5.0 degrees_north 5.0 degrees_east) time: mean (interval: 1 month)</dd></dl></div><div class='xr-var-data'><pre>array([[[[            nan,             nan,             nan, ...,
                      nan,             nan,             nan],
         [            nan,             nan,             nan, ...,
                      nan,             nan,             nan],
         [            nan,             nan,             nan, ...,
                      nan,             nan,             nan],
         ...,
         [            nan,             nan,             nan, ...,
                      nan,             nan,             nan],
         [            nan,             nan,             nan, ...,
                      nan,             nan,             nan],
         [            nan,             nan,             nan, ...,
                      nan,             nan,             nan]],

        [[            nan,             nan,             nan, ...,
                      nan,             nan,             nan],
         [            nan,             nan,             nan, ...,
                      nan,             nan,             nan],
         [            nan,             nan,             nan, ...,
                      nan,             nan,             nan],
...
         [ 1.54616375e+00,  1.97285720e+00,  2.45976022e+00, ...,
           5.55669028e-01,  8.88993989e-01,  1.17421258e+00],
         [ 9.68492519e-01,  1.21256566e+00,  1.50853323e+00, ...,
           4.93693133e-01,  6.35988328e-01,  8.14193135e-01],
         [ 1.08255246e+00,  1.11975513e+00,  1.15723724e+00, ...,
           1.00441405e+00,  1.01708203e+00,  1.04346370e+00]],

        [[ 1.57407473e+00,  1.60624493e+00,  1.65689972e+00, ...,
           1.58375375e+00,  1.56412859e+00,  1.56145613e+00],
         [ 2.22426256e+00,  2.26907019e+00,  2.34663866e+00, ...,
           1.92821146e+00,  2.02252304e+00,  2.14819245e+00],
         [ 2.29607263e+00,  2.51979724e+00,  2.53330857e+00, ...,
           1.44358581e+00,  1.65066217e+00,  1.98293981e+00],
         ...,
         [ 2.17719447e-01,  2.70125834e-01,  4.04586054e-01, ...,
           5.39498786e-01,  4.04716454e-01,  2.50956939e-01],
         [-1.70602919e-01, -1.34105214e-01, -3.91553878e-02, ...,
          -2.31120082e-02, -8.34816267e-02, -1.14405931e-01],
         [ 3.70798748e-01,  3.83807088e-01,  3.98897261e-01, ...,
           3.68470977e-01,  3.56069785e-01,  3.56940381e-01]]]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f84ac716-5ead-438b-b5eb-77c226f8641b' class='xr-section-summary-in' type='checkbox'  ><label for='section-f84ac716-5ead-438b-b5eb-77c226f8641b' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-bc8830ff-4a29-4221-be0a-b4c3828d2f19' class='xr-index-data-in' type='checkbox'/><label for='index-bc8830ff-4a29-4221-be0a-b4c3828d2f19' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1850-01-01&#x27;, &#x27;1850-02-01&#x27;, &#x27;1850-03-01&#x27;, &#x27;1850-04-01&#x27;,
               &#x27;1850-05-01&#x27;, &#x27;1850-06-01&#x27;, &#x27;1850-07-01&#x27;, &#x27;1850-08-01&#x27;,
               &#x27;1850-09-01&#x27;, &#x27;1850-10-01&#x27;,
               ...
               &#x27;2022-09-01&#x27;, &#x27;2022-10-01&#x27;, &#x27;2022-11-01&#x27;, &#x27;2022-12-01&#x27;,
               &#x27;2023-01-01&#x27;, &#x27;2023-02-01&#x27;, &#x27;2023-03-01&#x27;, &#x27;2023-04-01&#x27;,
               &#x27;2023-05-01&#x27;, &#x27;2023-06-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=2082, freq=&#x27;MS&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-25d6bd95-3c67-4382-944d-35932277347c' class='xr-index-data-in' type='checkbox'/><label for='index-25d6bd95-3c67-4382-944d-35932277347c' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-87.5, -82.5, -77.5, -72.5, -67.5, -62.5, -57.5, -52.5, -47.5, -42.5,
       -37.5, -32.5, -27.5, -22.5, -17.5, -12.5,  -7.5,  -2.5,   2.5,   7.5,
        12.5,  17.5,  22.5,  27.5,  32.5,  37.5,  42.5,  47.5,  52.5,  57.5,
        62.5,  67.5,  72.5,  77.5,  82.5,  87.5],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-5b53bf8e-eefe-4273-9e27-fd064ed26243' class='xr-index-data-in' type='checkbox'/><label for='index-5b53bf8e-eefe-4273-9e27-fd064ed26243' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-177.5, -172.5, -167.5, -162.5, -157.5, -152.5, -147.5, -142.5, -137.5,
       -132.5, -127.5, -122.5, -117.5, -112.5, -107.5, -102.5,  -97.5,  -92.5,
        -87.5,  -82.5,  -77.5,  -72.5,  -67.5,  -62.5,  -57.5,  -52.5,  -47.5,
        -42.5,  -37.5,  -32.5,  -27.5,  -22.5,  -17.5,  -12.5,   -7.5,   -2.5,
          2.5,    7.5,   12.5,   17.5,   22.5,   27.5,   32.5,   37.5,   42.5,
         47.5,   52.5,   57.5,   62.5,   67.5,   72.5,   77.5,   82.5,   87.5,
         92.5,   97.5,  102.5,  107.5,  112.5,  117.5,  122.5,  127.5,  132.5,
        137.5,  142.5,  147.5,  152.5,  157.5,  162.5,  167.5,  172.5,  177.5],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>realization</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-4275f269-347b-4b05-94e4-81d500664c34' class='xr-index-data-in' type='checkbox'/><label for='index-4275f269-347b-4b05-94e4-81d500664c34' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 10, 2, 3, 4, 5, 6, 7, 8, 9], dtype=&#x27;int64&#x27;, name=&#x27;realization&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-7654e1de-8b49-4ffe-9f9c-da80accb8062' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-7654e1de-8b49-4ffe-9f9c-da80accb8062' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<div class="alert alert-block alert-warning">
<b>Note</b> <br>
    The <b>uncertainty estimation</b> doesn't consider the imprecision in the spatial mean due to limited spatial coverage. Be aware of this when interpreting the results, especially for early time periods.</a>
</div>
<div class="alert alert-block alert-info">
<b>Note</b> <br>
    The HadCUT5 model has 200 ensemble members, but we're using only the first 10 here. While this reduces processing time, be aware that it may lead to an underestimation of uncertainty.</a>
</div>
</section>
<section id="era5-reanalysis">
<h4>ERA5 reanalysis<a class="headerlink" href="#era5-reanalysis" title="Permalink to this heading">#</a></h4>
<p>Now, we load ERA5 from the <a class="reference external" href="https://doi.org/10.24381/cds.f17050d7">Climate Data Store (CDS)</a> using the <code class="docutils literal notranslate"><span class="pre">cdsapi</span></code>, including the land-sea mask.</p>
<ol class="arabic simple">
<li><p><strong>Setup Your CDS API Key</strong></p></li>
</ol>
<p>You’ll need a specific key to access the CDS programmatically:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">URL</span> <span class="o">=</span> <span class="s1">&#39;https://cds.climate.copernicus.eu/api/v2&#39;</span>
<span class="n">KEY</span> <span class="o">=</span> <span class="s1">&#39;##################################&#39;</span> <span class="c1"># add your key here the format should be as {uid}:{api-key}</span>
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-info">
<b>New to CDS?</b> Consider the <a href="https://ecmwf-projects.github.io/copernicus-training-c3s/cds-tutorial.html">CDS tutorial</a> for a detailed guide.
</div><ol class="arabic simple" start="2">
<li><p><strong>Retrieve the Data</strong></p></li>
</ol>
<p>Use the following code to pull the data from CDS:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">cdsapi</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">URL</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">KEY</span><span class="p">)</span>

<span class="n">c</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
  <span class="s1">&#39;reanalysis-era5-single-levels-monthly-means&#39;</span><span class="p">,</span>
  <span class="p">{</span>
    <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;netcdf&#39;</span><span class="p">,</span>
    <span class="s1">&#39;product_type&#39;</span><span class="p">:</span> <span class="s1">&#39;monthly_averaged_reanalysis&#39;</span><span class="p">,</span>
    <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;2m_temperature&#39;</span><span class="p">,</span> <span class="s1">&#39;land_sea_mask&#39;</span><span class="p">],</span>
    <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1950</span><span class="p">,</span> <span class="mi">2023</span><span class="p">)),</span>
    <span class="s1">&#39;month&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)),</span>
    <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;00:00&#39;</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="n">path_to</span><span class="p">[</span><span class="s1">&#39;era5&#39;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Unlike other datasets, ERA5 provides temperatures in Kelvin. Convert them to Celsius for easier interpretation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="n">path_to</span><span class="p">[</span><span class="s2">&quot;era5&quot;</span><span class="p">])</span> <span class="k">as</span> <span class="n">era5</span><span class="p">:</span>
    <span class="c1"># convert from Kelvin to Celsius</span>
    <span class="n">era5</span><span class="p">[</span><span class="s2">&quot;t2m&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">era5</span><span class="p">[</span><span class="s2">&quot;t2m&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="mf">273.15</span>
<span class="n">era5</span> <span class="o">=</span> <span class="n">streamline_coords</span><span class="p">(</span><span class="n">era5</span><span class="p">)</span>
<span class="n">era5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:  (lon: 1440, lat: 721, time: 876)
Coordinates:
  * lon      (lon) float32 -180.0 -179.8 -179.5 -179.2 ... 179.2 179.5 179.8
  * lat      (lat) float32 -90.0 -89.75 -89.5 -89.25 ... 89.25 89.5 89.75 90.0
  * time     (time) datetime64[ns] 1950-01-01 1950-02-01 ... 2022-12-01
Data variables:
    t2m      (time, lat, lon) float32 dask.array&lt;chunksize=(876, 27, 720), meta=np.ndarray&gt;
    lsm      (time, lat, lon) float32 dask.array&lt;chunksize=(876, 27, 720), meta=np.ndarray&gt;
Attributes:
    Conventions:  CF-1.6
    history:      2023-08-13 06:04:31 GMT by grib_to_netcdf-2.25.1: /opt/ecmw...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-dbe44ee0-b28e-41a6-ad11-b76025c964e3' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-dbe44ee0-b28e-41a6-ad11-b76025c964e3' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lon</span>: 1440</li><li><span class='xr-has-index'>lat</span>: 721</li><li><span class='xr-has-index'>time</span>: 876</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-60260ec7-dfe2-4abe-b8d0-b1f922e31d59' class='xr-section-summary-in' type='checkbox'  checked><label for='section-60260ec7-dfe2-4abe-b8d0-b1f922e31d59' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-180.0 -179.8 ... 179.5 179.8</div><input id='attrs-05d20cb0-60fc-4b99-a081-98d74abc168a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-05d20cb0-60fc-4b99-a081-98d74abc168a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9985bfd1-1c1e-4cae-9c4d-74902627b227' class='xr-var-data-in' type='checkbox'><label for='data-9985bfd1-1c1e-4cae-9c4d-74902627b227' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-180.  , -179.75, -179.5 , ...,  179.25,  179.5 ,  179.75],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-90.0 -89.75 -89.5 ... 89.75 90.0</div><input id='attrs-44d637c8-9d40-451b-8756-9477212a1aba' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-44d637c8-9d40-451b-8756-9477212a1aba' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6bb836eb-8f6e-4db7-8ef3-bb512e3382f9' class='xr-var-data-in' type='checkbox'><label for='data-6bb836eb-8f6e-4db7-8ef3-bb512e3382f9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>long_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([-90.  , -89.75, -89.5 , ...,  89.5 ,  89.75,  90.  ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1950-01-01 ... 2022-12-01</div><input id='attrs-a2032666-be35-4695-ace6-288f6acb9d8e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a2032666-be35-4695-ace6-288f6acb9d8e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-62822cfa-82e3-487f-a1e9-b72ef815d4b5' class='xr-var-data-in' type='checkbox'><label for='data-62822cfa-82e3-487f-a1e9-b72ef815d4b5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;1950-01-01T00:00:00.000000000&#x27;, &#x27;1950-02-01T00:00:00.000000000&#x27;,
       &#x27;1950-03-01T00:00:00.000000000&#x27;, ..., &#x27;2022-10-01T00:00:00.000000000&#x27;,
       &#x27;2022-11-01T00:00:00.000000000&#x27;, &#x27;2022-12-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4087446a-173d-4851-9a38-8891a62f4a89' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4087446a-173d-4851-9a38-8891a62f4a89' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>t2m</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(876, 27, 720), meta=np.ndarray&gt;</div><input id='attrs-e9e1a6d4-aab7-4f05-9d01-ee66a7b73d60' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e9e1a6d4-aab7-4f05-9d01-ee66a7b73d60' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d3131c91-c26d-40e6-916a-641767c1cb58' class='xr-var-data-in' type='checkbox'><label for='data-d3131c91-c26d-40e6-916a-641767c1cb58' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 3.39 GiB </td>
                        <td> 64.96 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (876, 721, 1440) </td>
                        <td> (876, 27, 720) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 54 chunks in 5 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="222" height="153" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="52" y2="42" style="stroke-width:2" />
  <line x1="10" y1="2" x2="52" y2="45" />
  <line x1="10" y1="4" x2="52" y2="47" />
  <line x1="10" y1="9" x2="52" y2="51" />
  <line x1="10" y1="11" x2="52" y2="54" />
  <line x1="10" y1="15" x2="52" y2="58" />
  <line x1="10" y1="18" x2="52" y2="60" />
  <line x1="10" y1="20" x2="52" y2="63" />
  <line x1="10" y1="24" x2="52" y2="67" />
  <line x1="10" y1="27" x2="52" y2="69" />
  <line x1="10" y1="31" x2="52" y2="74" />
  <line x1="10" y1="33" x2="52" y2="76" />
  <line x1="10" y1="38" x2="52" y2="81" />
  <line x1="10" y1="40" x2="52" y2="83" />
  <line x1="10" y1="42" x2="52" y2="85" />
  <line x1="10" y1="47" x2="52" y2="90" />
  <line x1="10" y1="49" x2="52" y2="92" />
  <line x1="10" y1="53" x2="52" y2="96" />
  <line x1="10" y1="55" x2="52" y2="98" />
  <line x1="10" y1="60" x2="52" y2="103" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="52" y1="42" x2="52" y2="103" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 52.94117647058824,42.94117647058824 52.94117647058824,103.02450980392157 10.0,60.083333333333336" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="52" y1="42" x2="172" y2="42" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="52" y2="42" style="stroke-width:2" />
  <line x1="70" y1="0" x2="112" y2="42" />
  <line x1="130" y1="0" x2="172" y2="42" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 172.94117647058823,42.94117647058824 52.94117647058824,42.94117647058824" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="52" y1="42" x2="172" y2="42" style="stroke-width:2" />
  <line x1="52" y1="45" x2="172" y2="45" />
  <line x1="52" y1="47" x2="172" y2="47" />
  <line x1="52" y1="51" x2="172" y2="51" />
  <line x1="52" y1="54" x2="172" y2="54" />
  <line x1="52" y1="58" x2="172" y2="58" />
  <line x1="52" y1="60" x2="172" y2="60" />
  <line x1="52" y1="63" x2="172" y2="63" />
  <line x1="52" y1="67" x2="172" y2="67" />
  <line x1="52" y1="69" x2="172" y2="69" />
  <line x1="52" y1="74" x2="172" y2="74" />
  <line x1="52" y1="76" x2="172" y2="76" />
  <line x1="52" y1="81" x2="172" y2="81" />
  <line x1="52" y1="83" x2="172" y2="83" />
  <line x1="52" y1="85" x2="172" y2="85" />
  <line x1="52" y1="90" x2="172" y2="90" />
  <line x1="52" y1="92" x2="172" y2="92" />
  <line x1="52" y1="96" x2="172" y2="96" />
  <line x1="52" y1="98" x2="172" y2="98" />
  <line x1="52" y1="103" x2="172" y2="103" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="52" y1="42" x2="52" y2="103" style="stroke-width:2" />
  <line x1="112" y1="42" x2="112" y2="103" />
  <line x1="172" y1="42" x2="172" y2="103" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="52.94117647058824,42.94117647058824 172.94117647058823,42.94117647058824 172.94117647058823,103.02450980392157 52.94117647058824,103.02450980392157" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="112.941176" y="123.024510" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="192.941176" y="72.982843" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,192.941176,72.982843)">721</text>
  <text x="21.470588" y="101.553922" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,21.470588,101.553922)">876</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lsm</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(876, 27, 720), meta=np.ndarray&gt;</div><input id='attrs-c3126d88-444a-4b9d-bd42-dd7eeea5d1c7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c3126d88-444a-4b9d-bd42-dd7eeea5d1c7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-be565fb7-2335-4ee2-ac69-ec79eb42d814' class='xr-var-data-in' type='checkbox'><label for='data-be565fb7-2335-4ee2-ac69-ec79eb42d814' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>(0 - 1)</dd><dt><span>long_name :</span></dt><dd>Land-sea mask</dd><dt><span>standard_name :</span></dt><dd>land_binary_mask</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 3.39 GiB </td>
                        <td> 64.96 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (876, 721, 1440) </td>
                        <td> (876, 27, 720) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 54 chunks in 4 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="222" height="153" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="52" y2="42" style="stroke-width:2" />
  <line x1="10" y1="2" x2="52" y2="45" />
  <line x1="10" y1="4" x2="52" y2="47" />
  <line x1="10" y1="9" x2="52" y2="51" />
  <line x1="10" y1="11" x2="52" y2="54" />
  <line x1="10" y1="15" x2="52" y2="58" />
  <line x1="10" y1="18" x2="52" y2="60" />
  <line x1="10" y1="20" x2="52" y2="63" />
  <line x1="10" y1="24" x2="52" y2="67" />
  <line x1="10" y1="27" x2="52" y2="69" />
  <line x1="10" y1="31" x2="52" y2="74" />
  <line x1="10" y1="33" x2="52" y2="76" />
  <line x1="10" y1="38" x2="52" y2="81" />
  <line x1="10" y1="40" x2="52" y2="83" />
  <line x1="10" y1="42" x2="52" y2="85" />
  <line x1="10" y1="47" x2="52" y2="90" />
  <line x1="10" y1="49" x2="52" y2="92" />
  <line x1="10" y1="53" x2="52" y2="96" />
  <line x1="10" y1="55" x2="52" y2="98" />
  <line x1="10" y1="60" x2="52" y2="103" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="52" y1="42" x2="52" y2="103" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 52.94117647058824,42.94117647058824 52.94117647058824,103.02450980392157 10.0,60.083333333333336" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="52" y1="42" x2="172" y2="42" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="52" y2="42" style="stroke-width:2" />
  <line x1="70" y1="0" x2="112" y2="42" />
  <line x1="130" y1="0" x2="172" y2="42" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 172.94117647058823,42.94117647058824 52.94117647058824,42.94117647058824" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="52" y1="42" x2="172" y2="42" style="stroke-width:2" />
  <line x1="52" y1="45" x2="172" y2="45" />
  <line x1="52" y1="47" x2="172" y2="47" />
  <line x1="52" y1="51" x2="172" y2="51" />
  <line x1="52" y1="54" x2="172" y2="54" />
  <line x1="52" y1="58" x2="172" y2="58" />
  <line x1="52" y1="60" x2="172" y2="60" />
  <line x1="52" y1="63" x2="172" y2="63" />
  <line x1="52" y1="67" x2="172" y2="67" />
  <line x1="52" y1="69" x2="172" y2="69" />
  <line x1="52" y1="74" x2="172" y2="74" />
  <line x1="52" y1="76" x2="172" y2="76" />
  <line x1="52" y1="81" x2="172" y2="81" />
  <line x1="52" y1="83" x2="172" y2="83" />
  <line x1="52" y1="85" x2="172" y2="85" />
  <line x1="52" y1="90" x2="172" y2="90" />
  <line x1="52" y1="92" x2="172" y2="92" />
  <line x1="52" y1="96" x2="172" y2="96" />
  <line x1="52" y1="98" x2="172" y2="98" />
  <line x1="52" y1="103" x2="172" y2="103" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="52" y1="42" x2="52" y2="103" style="stroke-width:2" />
  <line x1="112" y1="42" x2="112" y2="103" />
  <line x1="172" y1="42" x2="172" y2="103" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="52.94117647058824,42.94117647058824 172.94117647058823,42.94117647058824 172.94117647058823,103.02450980392157 52.94117647058824,103.02450980392157" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="112.941176" y="123.024510" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="192.941176" y="72.982843" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,192.941176,72.982843)">721</text>
  <text x="21.470588" y="101.553922" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,21.470588,101.553922)">876</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-c95e779f-4064-4bb7-9d2e-9e4e547e74b5' class='xr-section-summary-in' type='checkbox'  ><label for='section-c95e779f-4064-4bb7-9d2e-9e4e547e74b5' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-bf29a358-7986-45c0-81a7-c362bf254c12' class='xr-index-data-in' type='checkbox'/><label for='index-bf29a358-7986-45c0-81a7-c362bf254c12' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -180.0, -179.75,  -179.5, -179.25,  -179.0, -178.75,  -178.5, -178.25,
        -178.0, -177.75,
       ...
         177.5,  177.75,   178.0,  178.25,   178.5,  178.75,   179.0,  179.25,
         179.5,  179.75],
      dtype=&#x27;float32&#x27;, name=&#x27;lon&#x27;, length=1440))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-480cefc9-5a8c-4ad4-9efc-faeda03c9453' class='xr-index-data-in' type='checkbox'/><label for='index-480cefc9-5a8c-4ad4-9efc-faeda03c9453' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -90.0, -89.75,  -89.5, -89.25,  -89.0, -88.75,  -88.5, -88.25,  -88.0,
       -87.75,
       ...
        87.75,   88.0,  88.25,   88.5,  88.75,   89.0,  89.25,   89.5,  89.75,
         90.0],
      dtype=&#x27;float32&#x27;, name=&#x27;lat&#x27;, length=721))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-04ac8259-287f-4696-86ac-a586c051aa65' class='xr-index-data-in' type='checkbox'/><label for='index-04ac8259-287f-4696-86ac-a586c051aa65' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1950-01-01&#x27;, &#x27;1950-02-01&#x27;, &#x27;1950-03-01&#x27;, &#x27;1950-04-01&#x27;,
               &#x27;1950-05-01&#x27;, &#x27;1950-06-01&#x27;, &#x27;1950-07-01&#x27;, &#x27;1950-08-01&#x27;,
               &#x27;1950-09-01&#x27;, &#x27;1950-10-01&#x27;,
               ...
               &#x27;2022-03-01&#x27;, &#x27;2022-04-01&#x27;, &#x27;2022-05-01&#x27;, &#x27;2022-06-01&#x27;,
               &#x27;2022-07-01&#x27;, &#x27;2022-08-01&#x27;, &#x27;2022-09-01&#x27;, &#x27;2022-10-01&#x27;,
               &#x27;2022-11-01&#x27;, &#x27;2022-12-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=876, freq=&#x27;MS&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-89222bba-2665-44f9-8db3-c15f4c98ac2d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-89222bba-2665-44f9-8db3-c15f4c98ac2d' class='xr-section-summary' >Attributes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>history :</span></dt><dd>2023-08-13 06:04:31 GMT by grib_to_netcdf-2.25.1: /opt/ecmwf/mars-client/bin/grib_to_netcdf.bin -S param -o /cache/data3/adaptor.mars.internal-1691906602.3592243-18269-3-f65296cb-f0aa-4c15-9e5e-57b457d8033b.nc /cache/tmp/f65296cb-f0aa-4c15-9e5e-57b457d8033b-adaptor.mars.internal-1691906271.6359887-18269-6-tmp.grib</dd></dl></div></li></ul></div></div></div></div>
</div>
</section>
</section>
<section id="calculation-of-spatial-averages">
<h3>Calculation of Spatial Averages<a class="headerlink" href="#calculation-of-spatial-averages" title="Permalink to this heading">#</a></h3>
<p>In this section, we’ll delve into the process of calculating spatial averages from different datasets, specifically accounting for two essential factors:</p>
<ul class="simple">
<li><p><strong>Longitude-Latitude Grid Representation</strong>: The data is represented on a regular grid, which can lead to inflation of areas towards the poles.</p></li>
<li><p><strong>Land Proportion Weighting</strong>: When averaging over land, it’s necessary to weigh the grid points according to the proportion of land in each cell.</p></li>
</ul>
<p>These considerations are integral to accurately representing spatial patterns and trends. Here’s how we’ll proceed:</p>
<p><strong>Step 1: Define the Weighted Spatial Average Function</strong></p>
<p>First, we need a function that takes into account the above factors and can calculate the spatial average, even for subregions, by specifying a land-sea mask.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">weighted_spatial_average</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">land_mask</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the weighted spatial average of a DataArray.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    da : xr.DataArray</span>
<span class="sd">        The DataArray to average.</span>
<span class="sd">    weights : xr.DataArray, optional</span>
<span class="sd">        A DataArray with the same dimensions as `da` containing the weights.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="o">**</span><span class="n">region</span><span class="p">)</span>

    <span class="c1"># Area weighting: calculate the area of each grid cell</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">lat</span><span class="p">))</span>

    <span class="c1"># Optionally, apply land-sea mask</span>
    <span class="k">if</span> <span class="n">land_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">land_mask</span> <span class="o">=</span> <span class="n">land_mask</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="o">**</span><span class="n">region</span><span class="p">)</span>
        <span class="c1"># fill up nan values with 0 so that they don&#39;t affect the weighted mean</span>
        <span class="n">land_mask</span> <span class="o">=</span> <span class="n">land_mask</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="c1"># combine land mask with weights</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="n">weights</span> <span class="o">*</span> <span class="n">land_mask</span>

    <span class="c1"># Compute the weighted mean</span>
    <span class="k">return</span> <span class="n">da</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Step 2: Prepare Dictionaries for Datasets and Land-Sea Masks</strong></p>
<p>Before we can compute the averages, we need to define dictionaries that associate the data with the corresponding land-sea masks.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temps</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;HadCRUT&quot;</span><span class="p">:</span> <span class="n">hadcrut</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">],</span>
    <span class="s2">&quot;HadCRUT_ensemble&quot;</span><span class="p">:</span> <span class="n">hadcrut</span><span class="p">[</span><span class="s2">&quot;ensemble&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Berkeley&quot;</span><span class="p">:</span> <span class="n">berkeley</span><span class="p">[</span><span class="s2">&quot;temperature&quot;</span><span class="p">],</span>
    <span class="s2">&quot;GISTEMP&quot;</span><span class="p">:</span> <span class="n">gistemp</span><span class="p">[</span><span class="s2">&quot;tempanomaly&quot;</span><span class="p">],</span>
    <span class="s2">&quot;NOAA&quot;</span><span class="p">:</span> <span class="n">noaa</span><span class="p">[</span><span class="s2">&quot;anom&quot;</span><span class="p">],</span>
    <span class="s2">&quot;ERA5&quot;</span><span class="p">:</span> <span class="n">era5</span><span class="p">[</span><span class="s2">&quot;t2m&quot;</span><span class="p">],</span>
<span class="p">}</span>
<span class="n">land_masks</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;HadCRUT&quot;</span><span class="p">:</span> <span class="n">hadcrut</span><span class="p">[</span><span class="s2">&quot;weights&quot;</span><span class="p">],</span>
    <span class="s2">&quot;HadCRUT_ensemble&quot;</span><span class="p">:</span> <span class="n">hadcrut</span><span class="p">[</span><span class="s2">&quot;weights&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Berkeley&quot;</span><span class="p">:</span> <span class="n">berkeley</span><span class="p">[</span><span class="s2">&quot;land_mask&quot;</span><span class="p">],</span>
    <span class="s2">&quot;GISTEMP&quot;</span><span class="p">:</span> <span class="n">gistemp</span><span class="p">[</span><span class="s2">&quot;mask&quot;</span><span class="p">],</span>
    <span class="s2">&quot;NOAA&quot;</span><span class="p">:</span> <span class="n">noaa</span><span class="p">[</span><span class="s2">&quot;lsm&quot;</span><span class="p">],</span>
    <span class="s2">&quot;ERA5&quot;</span><span class="p">:</span> <span class="n">era5</span><span class="p">[</span><span class="s2">&quot;lsm&quot;</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Step 3: Iterate Over Datasets to Calculate Mean Temperatures</strong></p>
<p>Finally, we’ll loop through our datasets and compute the mean temperatures for a specified <code class="docutils literal notranslate"><span class="pre">region</span></code>, such as the Arctic.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region</span> <span class="o">=</span> <span class="s2">&quot;Arctic&quot;</span>

<span class="n">temp_evolution</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">temps</span><span class="p">:</span>
    <span class="n">spatial_average</span> <span class="o">=</span> <span class="n">weighted_spatial_average</span><span class="p">(</span>
        <span class="n">temps</span><span class="p">[</span><span class="n">source</span><span class="p">],</span> <span class="n">REGIONS</span><span class="p">[</span><span class="n">region</span><span class="p">],</span> <span class="n">land_masks</span><span class="p">[</span><span class="n">source</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="c1"># Use dask for the high-resolution ERA5 data</span>
    <span class="k">with</span> <span class="n">ProgressBar</span><span class="p">():</span>
        <span class="n">temp_evolution</span><span class="p">[</span><span class="n">source</span><span class="p">]</span> <span class="o">=</span> <span class="n">spatial_average</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">temp_evolution</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">temp_evolution</span><span class="p">)</span>
<span class="n">temp_evolution</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[########################################] | 100% Completed | 91.32 ss
</pre></div>
</div>
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:           (time: 2082, realization: 10)
Coordinates:
  * time              (time) datetime64[ns] 1850-01-01 1850-02-01 ... 2023-06-01
  * realization       (realization) int64 1 10 2 3 4 5 6 7 8 9
Data variables:
    HadCRUT           (time) float64 -1.962 -0.6203 -1.374 ... 2.094 2.331 1.309
    HadCRUT_ensemble  (realization, time) float64 -2.02 -0.3699 ... 2.168 1.19
    Berkeley          (time) float64 -1.055 0.07 0.6092 0.2195 ... nan nan nan
    GISTEMP           (time) float64 nan nan nan nan ... 2.965 2.102 2.159 1.558
    NOAA              (time) float64 -1.497 -0.4415 -1.032 ... 1.795 2.349 1.141
    ERA5              (time) float32 nan nan nan nan nan ... nan nan nan nan nan</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-30d1bec0-be79-4375-b077-f3c4a61911f6' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-30d1bec0-be79-4375-b077-f3c4a61911f6' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 2082</li><li><span class='xr-has-index'>realization</span>: 10</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-047f6734-16ff-4e50-b3ea-580b49fec909' class='xr-section-summary-in' type='checkbox'  checked><label for='section-047f6734-16ff-4e50-b3ea-580b49fec909' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1850-01-01 ... 2023-06-01</div><input id='attrs-91b2ef73-f8c5-4fd6-a993-77cf59f24469' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-91b2ef73-f8c5-4fd6-a993-77cf59f24469' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2e1cf891-8657-4b7c-a1b1-21f5f6edb34c' class='xr-var-data-in' type='checkbox'><label for='data-2e1cf891-8657-4b7c-a1b1-21f5f6edb34c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;1850-01-01T00:00:00.000000000&#x27;, &#x27;1850-02-01T00:00:00.000000000&#x27;,
       &#x27;1850-03-01T00:00:00.000000000&#x27;, ..., &#x27;2023-04-01T00:00:00.000000000&#x27;,
       &#x27;2023-05-01T00:00:00.000000000&#x27;, &#x27;2023-06-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>realization</span></div><div class='xr-var-dims'>(realization)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 10 2 3 4 5 6 7 8 9</div><input id='attrs-42cb844a-3498-4b4e-a9e7-84c640d7aff4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-42cb844a-3498-4b4e-a9e7-84c640d7aff4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-95b0cf3e-8e26-4c9a-95b7-d2c376549b94' class='xr-var-data-in' type='checkbox'><label for='data-95b0cf3e-8e26-4c9a-95b7-d2c376549b94' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1, 10,  2,  3,  4,  5,  6,  7,  8,  9])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e1c0dc1d-4c23-4038-9833-c12e474e91c0' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e1c0dc1d-4c23-4038-9833-c12e474e91c0' class='xr-section-summary' >Data variables: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>HadCRUT</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-1.962 -0.6203 ... 2.331 1.309</div><input id='attrs-8675210b-7f89-4f15-94c4-daadcd850879' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8675210b-7f89-4f15-94c4-daadcd850879' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-88892579-b9b7-450e-a4d2-4c590d757edb' class='xr-var-data-in' type='checkbox'><label for='data-88892579-b9b7-450e-a4d2-4c590d757edb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-1.9617599 , -0.62034782, -1.37401519, ...,  2.0942024 ,
        2.33117465,  1.30903893])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>HadCRUT_ensemble</span></div><div class='xr-var-dims'>(realization, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-2.02 -0.3699 -1.611 ... 2.168 1.19</div><input id='attrs-b503e697-43fe-4c4f-a72f-de9077bb6556' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b503e697-43fe-4c4f-a72f-de9077bb6556' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0d92ceb5-8e53-4bfa-b91d-0034734ee67e' class='xr-var-data-in' type='checkbox'><label for='data-0d92ceb5-8e53-4bfa-b91d-0034734ee67e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[-2.01999589, -0.36993824, -1.61123542, ...,  2.14151082,
         2.36646759,  1.27600144],
       [-1.91245621, -0.63479389, -1.52671185, ...,  2.08580137,
         2.2903865 ,  1.28526516],
       [-2.34974854, -0.59273105, -1.74163133, ...,  2.14700645,
         2.20714585,  1.39895018],
       ...,
       [-1.80512702, -0.65093705, -1.20507997, ...,  2.19351863,
         2.56555828,  1.54639039],
       [-2.4662412 , -1.3800114 , -1.47008776, ...,  2.3676275 ,
         2.12674524,  1.25311858],
       [-2.63635961, -1.45741242, -1.33025937, ...,  1.97067019,
         2.1679846 ,  1.18965592]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Berkeley</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-1.055 0.07 0.6092 ... nan nan nan</div><input id='attrs-5abdc6f5-a5d1-4ecf-90c8-eb2e61750d86' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5abdc6f5-a5d1-4ecf-90c8-eb2e61750d86' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4b51cce6-229d-4ade-9bb6-662fac3a049e' class='xr-var-data-in' type='checkbox'><label for='data-4b51cce6-229d-4ade-9bb6-662fac3a049e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-1.0548457 ,  0.07000187,  0.60923286, ...,         nan,
               nan,         nan])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>GISTEMP</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan ... 2.102 2.159 1.558</div><input id='attrs-7e69e290-bc70-42bc-be42-ca2bd9d60aad' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7e69e290-bc70-42bc-be42-ca2bd9d60aad' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a32a468d-4f9e-4596-9e6f-df6206f7e7ac' class='xr-var-data-in' type='checkbox'><label for='data-a32a468d-4f9e-4596-9e6f-df6206f7e7ac' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([       nan,        nan,        nan, ..., 2.10194436, 2.15933854,
       1.55775116])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>NOAA</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-1.497 -0.4415 ... 2.349 1.141</div><input id='attrs-cd9e9129-db88-44bf-9976-a4694d474958' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-cd9e9129-db88-44bf-9976-a4694d474958' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-94ff9fc6-9e06-4b1a-8765-b47978ed3c5a' class='xr-var-data-in' type='checkbox'><label for='data-94ff9fc6-9e06-4b1a-8765-b47978ed3c5a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-1.49688411, -0.44154584, -1.03150738, ...,  1.79532774,
        2.34930796,  1.14132655])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ERA5</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-f402fc12-5bdb-4739-9c77-d925f2fb2498' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f402fc12-5bdb-4739-9c77-d925f2fb2498' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0036c7e8-2864-421f-9ad4-2d81394b4a9f' class='xr-var-data-in' type='checkbox'><label for='data-0036c7e8-2864-421f-9ad4-2d81394b4a9f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([nan, nan, nan, ..., nan, nan, nan], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-429abda8-8e5c-4e64-9fb4-e27a601fc447' class='xr-section-summary-in' type='checkbox'  ><label for='section-429abda8-8e5c-4e64-9fb4-e27a601fc447' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-67dd3f5b-34a1-4bef-8c9e-84015f3cf252' class='xr-index-data-in' type='checkbox'/><label for='index-67dd3f5b-34a1-4bef-8c9e-84015f3cf252' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1850-01-01&#x27;, &#x27;1850-02-01&#x27;, &#x27;1850-03-01&#x27;, &#x27;1850-04-01&#x27;,
               &#x27;1850-05-01&#x27;, &#x27;1850-06-01&#x27;, &#x27;1850-07-01&#x27;, &#x27;1850-08-01&#x27;,
               &#x27;1850-09-01&#x27;, &#x27;1850-10-01&#x27;,
               ...
               &#x27;2022-09-01&#x27;, &#x27;2022-10-01&#x27;, &#x27;2022-11-01&#x27;, &#x27;2022-12-01&#x27;,
               &#x27;2023-01-01&#x27;, &#x27;2023-02-01&#x27;, &#x27;2023-03-01&#x27;, &#x27;2023-04-01&#x27;,
               &#x27;2023-05-01&#x27;, &#x27;2023-06-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=2082, freq=&#x27;MS&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>realization</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-e7b2175b-dbbf-4b9c-8d1b-456d7d74537b' class='xr-index-data-in' type='checkbox'/><label for='index-e7b2175b-dbbf-4b9c-8d1b-456d7d74537b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 10, 2, 3, 4, 5, 6, 7, 8, 9], dtype=&#x27;int64&#x27;, name=&#x27;realization&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-7825e494-4960-4c38-a7b1-592d64e3d4b8' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-7825e494-4960-4c38-a7b1-592d64e3d4b8' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<div class="alert alert-block alert-info">
<b>Note</b>: By changing the `region`, you can easily calculate averages for any other pre-defined region, allowing for versatile analysis and comparisons.
</div><p><strong>Step 4: Aligning Datasets to a Common Reference Period</strong></p>
<p>Let’s take note that while all datasets except ERA5 are already represented as anomalies, they have different reference periods. This means that we cannot directly compare them with each other. To align them, we’ll calculate anomalies relative to the period 1991-2020.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show anomalies with respect to the 1991-2020 climatology</span>
<span class="n">temp_evolution</span> <span class="o">=</span> <span class="n">temp_evolution</span> <span class="o">-</span> <span class="n">temp_evolution</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">REF_PERIOD</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Step 5: Calculate Anomalies Relative to the Pre-Industrial Era</strong></p>
<p>Next, we’ll analyze the temperature increase relative to the pre-industrial era, defined here as 1850-1900. We calculate the reference value as the average of the anomalies of all datasets within this time frame, excluding the HadCRUT ensemble members.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">anom_1850_1900</span> <span class="o">=</span> <span class="n">temp_evolution</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">(</span><span class="s2">&quot;HadCRUT_ensemble&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span>
    <span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;1850&quot;</span><span class="p">,</span> <span class="s2">&quot;1900&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">mean_1850_1900</span> <span class="o">=</span> <span class="n">anom_1850_1900</span><span class="o">.</span><span class="n">to_array</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">mean_1850_1900</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray ()&gt;
array(-2.14435069)</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-c2f76721-902d-41ec-9a21-5b9dd31a8195' class='xr-array-in' type='checkbox' checked><label for='section-c2f76721-902d-41ec-9a21-5b9dd31a8195' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>-2.144</span></div><div class='xr-array-data'><pre>array(-2.14435069)</pre></div></div></li><li class='xr-section-item'><input id='section-c6afca39-d8f2-4d57-adad-67cf312e6bad' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-c6afca39-d8f2-4d57-adad-67cf312e6bad' class='xr-section-summary'  title='Expand/collapse section'>Coordinates: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'></ul></div></li><li class='xr-section-item'><input id='section-d9bfbebb-c993-4e61-a333-5b68ee90b975' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-d9bfbebb-c993-4e61-a333-5b68ee90b975' class='xr-section-summary'  title='Expand/collapse section'>Indexes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'></ul></div></li><li class='xr-section-item'><input id='section-044bcbaa-1e2a-47fe-b5e4-e6aff652615c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-044bcbaa-1e2a-47fe-b5e4-e6aff652615c' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p><strong>Step 6: Smooth the Time Series Data</strong></p>
<p>To provide a clearer picture, we’ll calculate the 60-month (5-year) centered moving average of the time series. This helps reduce inter-annual climate fluctuations, such as those due to ENSO (El Niño-Southern Oscillation).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp_evolution_smooth</span> <span class="o">=</span> <span class="n">temp_evolution</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Step 7: Assess the Uncertainty of the HadCRUT Model</strong></p>
<p>Understanding uncertainty is crucial. Here, we calculate the confidence interval for the HadCRUT model as the minimum/maximum value of the ensemble members for each time step.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">confidence_interval</span> <span class="o">=</span> <span class="n">temp_evolution_smooth</span><span class="p">[</span><span class="s2">&quot;HadCRUT_ensemble&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;realization&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/nikos_mastrantonas/anaconda3/envs/tutorial/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1577: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
</pre></div>
</div>
</div>
</div>
<p><strong>Et voilà! Visualization Time</strong></p>
<p>With the calculations complete, we’re now ready to compare all the time series in a single graph. This will give us a comprehensive view of how temperature anomalies have evolved over different periods:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">line_HadCRUT</span><span class="p">,</span> <span class="o">=</span> <span class="n">temp_evolution_smooth</span><span class="p">[</span><span class="s2">&quot;HadCRUT&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;HadCRUT&quot;</span><span class="p">)</span>
<span class="n">line_Berkeley</span><span class="p">,</span> <span class="o">=</span> <span class="n">temp_evolution_smooth</span><span class="p">[</span><span class="s2">&quot;Berkeley&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Berkeley&quot;</span><span class="p">)</span>
<span class="n">line_GISTEMP</span><span class="p">,</span> <span class="o">=</span> <span class="n">temp_evolution_smooth</span><span class="p">[</span><span class="s2">&quot;GISTEMP&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;GISTEMP&quot;</span><span class="p">)</span>
<span class="n">line_NOAA</span><span class="p">,</span> <span class="o">=</span> <span class="n">temp_evolution_smooth</span><span class="p">[</span><span class="s2">&quot;NOAA&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;NOAA&quot;</span><span class="p">)</span>
<span class="n">line_ERA5</span><span class="p">,</span> <span class="o">=</span> <span class="n">temp_evolution_smooth</span><span class="p">[</span><span class="s2">&quot;ERA5&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;ERA5&quot;</span><span class="p">)</span>
<span class="n">area_HadCRUT</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <span class="n">confidence_interval</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
    <span class="n">confidence_interval</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">quantile</span><span class="o">=</span><span class="mf">0.0</span><span class="p">),</span>
    <span class="n">confidence_interval</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">quantile</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span>
    <span class="n">color</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.prop_cycle&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">by_key</span><span class="p">()[</span><span class="s1">&#39;color&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="c1"># same color (1st in the order) as the mean data from the same dataset (HadCRUT)</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
    <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
    <span class="p">[(</span><span class="n">line_HadCRUT</span><span class="p">,</span> <span class="n">area_HadCRUT</span><span class="p">),</span> <span class="c1"># add in the same handle the line and patch for the HadCRUT mean and ensembles</span>
      <span class="n">line_Berkeley</span><span class="p">,</span> <span class="n">line_GISTEMP</span><span class="p">,</span> <span class="n">line_NOAA</span><span class="p">,</span> <span class="n">line_ERA5</span><span class="p">],</span> 
    <span class="p">[</span><span class="s1">&#39;HadCRUT&#39;</span><span class="p">,</span> <span class="s1">&#39;Berkeley&#39;</span><span class="p">,</span> <span class="s1">&#39;GISTEMP&#39;</span><span class="p">,</span> <span class="s1">&#39;NOAA&#39;</span><span class="p">,</span> <span class="s1">&#39;ERA5&#39;</span><span class="p">],</span>
    <span class="n">ncols</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper center&quot;</span>\
    <span class="p">)</span>


<span class="n">ax2</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">YearLocator</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">region</span><span class="si">}</span><span class="s2"> Mean Temperature Anomaly (in ºC) since 1850&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="o">-</span><span class="mf">0.02</span><span class="p">,</span>
    <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;Relative to </span><span class="se">\n</span><span class="s2">1991-2020&quot;</span><span class="p">,</span>
    <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span>
    <span class="n">va</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span>
    <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="mf">1.02</span><span class="p">,</span>
    <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;Increase above </span><span class="se">\n</span><span class="s2">1850-1900</span><span class="se">\n</span><span class="s2"> reference level&quot;</span><span class="p">,</span>
    <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
    <span class="n">va</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span>
    <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">mean_1850_1900</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;.5&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>

<span class="n">yticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax2_yticks</span> <span class="o">=</span> <span class="n">yticks</span> <span class="o">+</span> <span class="n">mean_1850_1900</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">ax2_yticks</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">yticks</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">4.1</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">4.1</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7d57c7a39beab935443ce2b90f148317f4c7615ed78a404aa0ed564f50014432.png" src="_images/7d57c7a39beab935443ce2b90f148317f4c7615ed78a404aa0ed564f50014432.png" />
</div>
</div>
</section>
<section id="understanding-model-discrepancies">
<h3>Understanding Model Discrepancies<a class="headerlink" href="#understanding-model-discrepancies" title="Permalink to this heading">#</a></h3>
<p>Let’s kick off by observing that datasets from the mid-last century onwards generally exhibit a <strong>high degree of agreement</strong>. But to truly quantify this, we’re going to calculate the spread, or in simpler terms, the range between the highest and lowest values for each time point. It’s fascinating how the differences between datasets tend to grow as we delve further back in time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qs</span> <span class="o">=</span> <span class="n">temp_evolution_smooth</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">([</span><span class="s2">&quot;HadCRUT_ensemble&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">to_array</span><span class="p">()</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;variable&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">qs</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="s1">&#39;quantile&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">add_legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Model spread (ºC)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Disagreement between models decreases over time&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/nikos_mastrantonas/anaconda3/envs/tutorial/lib/python3.10/site-packages/numpy/lib/nanfunctions.py:1577: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanquantile_1d, axis, a, q,
</pre></div>
</div>
<img alt="_images/495a1607e7003419a7f31a2b45ff5ee4190880e58e8b0c237543d04305160b7b.png" src="_images/495a1607e7003419a7f31a2b45ff5ee4190880e58e8b0c237543d04305160b7b.png" />
</div>
</div>
<p>Why do these differences occur? There’s a plethora of reasons, but one significant factor stands out: as we move further back in time, there were fewer observation stations, leading to limited spatial coverage. Let’s illustrate this using <strong>BerkeleyEarth</strong> as our muse.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Robinson</span><span class="p">())</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">8</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">berkeley</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;1850-01&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">berkeley</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;1900-01&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">berkeley</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;1950-01&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">:</span>
    <span class="n">a</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;.3&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">a</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;.7&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">a</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">lw</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;.3&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">a</span><span class="o">.</span><span class="n">set_global</span><span class="p">()</span>
    <span class="n">a</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;1850&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;1900&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;1950&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ed8aec035cdc8fcd576fef37073f75f345526aa0c32bb44b5db922b8a14413ca.png" src="_images/ed8aec035cdc8fcd576fef37073f75f345526aa0c32bb44b5db922b8a14413ca.png" />
</div>
</div>
<p>Reiterating an essential point: the uncertainty displayed for the HadCRUT model seems on the lower side. While a part of this can be attributed to a minimal ensemble representation, it’s still a tad underestimated, especially when considering the beginning of the timeline and the limited spatial grasp.</p>
</section>
<section id="wrapping-up-with-earth-s-temperature">
<h3>Wrapping Up with Earth’s Temperature<a class="headerlink" href="#wrapping-up-with-earth-s-temperature" title="Permalink to this heading">#</a></h3>
<p>Now for the grand finale! With our detective caps on, we’re going to address a burning question: Just how warm is our dear Earth?</p>
<p>By using absolute temperatures from <strong>ERA5</strong>, let’s compute the average temperature for the reference period (1991-2020) over a region of our choice.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Taking Earth&#39;s mean temperature</span>
<span class="n">region</span> <span class="o">=</span> <span class="s2">&quot;Arctic&quot;</span>  <span class="c1"># &lt;--- define the region here</span>

<span class="n">land_mask</span> <span class="o">=</span> <span class="n">era5</span><span class="p">[</span><span class="s2">&quot;lsm&quot;</span><span class="p">]</span>
<span class="n">clim_temp_era5</span> <span class="o">=</span> <span class="n">era5</span><span class="p">[</span><span class="s2">&quot;t2m&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">REF_PERIOD</span><span class="p">)</span>  <span class="c1"># consider the reference period</span>
<span class="n">clim_temp_era5</span> <span class="o">=</span> <span class="n">weighted_spatial_average</span><span class="p">(</span><span class="n">clim_temp_era5</span><span class="p">,</span> <span class="n">REGIONS</span><span class="p">[</span><span class="n">region</span><span class="p">],</span> <span class="n">land_mask</span><span class="o">=</span><span class="n">land_mask</span><span class="p">)</span>

<span class="k">with</span> <span class="n">ProgressBar</span><span class="p">():</span>
    <span class="n">clim_temp_era5</span> <span class="o">=</span> <span class="n">clim_temp_era5</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>  <span class="c1"># compute the result</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[                                        ] | 0% Completed | 256.20 us
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[########################################] | 100% Completed | 84.48 s
</pre></div>
</div>
</div>
</div>
<p>Now that we have monthly anomalies for our reference period, computing the temporal average correctly requires to weight each month by the respective number of days. Let’s do this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">days_in_month</span> <span class="o">=</span> <span class="n">clim_temp_era5</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days_in_month</span>
<span class="n">clim_temp_era5</span> <span class="o">=</span> <span class="p">(</span><span class="n">clim_temp_era5</span> <span class="o">*</span> <span class="n">days_in_month</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">days_in_month</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">region</span><span class="si">}</span><span class="s1"> mean temperature between 1991 and 2020 was </span><span class="si">{</span><span class="n">clim_temp_era5</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1"> °C.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Arctic mean temperature between 1991 and 2020 was -12.7 °C.
</pre></div>
</div>
</div>
</div>
</section>
<section id="in-retrospect">
<h3>In Retrospect…<a class="headerlink" href="#in-retrospect" title="Permalink to this heading">#</a></h3>
<p>And there you have it! From discerning Earth’s surface temperature changes since 1850, grappling with an array of datasets using handy tools like dask and regionmask, to even mastering the art of calculating weighted averages spatially and temporally, we’ve covered a lot of ground together.</p>
<p>Thank you for your undivided attention! If you found this illuminating, you’re in for a treat. Our next segment promises an intriguing verification of the ERA5 surface temperatures in Europe.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="01_greenhouse_gases.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Chapter 1: Greenhouses Gases - The prime suspect</p>
      </div>
    </a>
    <a class="right-next"
       href="02b_temperature.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Chapter 2: Taking Earth’s Temperature</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-i-it-s-getting-hot-ter-in-here-long-term-development-of-global-earth-temperature-since-1850">Part I: It’s getting hot(ter) in here: Long-Term Development of Global Earth Temperature Since 1850</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-set-up-your-toolkit">Getting Set Up: Your Toolkit</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-streamline-the-data">Download and streamline the data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#noaa-globaltemp">NOAA GlobalTemp</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#berkeley-earth">Berkeley Earth</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#gistemp">GISTEMP</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hadcrut5">HadCRUT5</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#era5-reanalysis">ERA5 reanalysis</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculation-of-spatial-averages">Calculation of Spatial Averages</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-model-discrepancies">Understanding Model Discrepancies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#wrapping-up-with-earth-s-temperature">Wrapping Up with Earth’s Temperature</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#in-retrospect">In Retrospect…</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Niclas Rieger, Nikolaos Mastrantonas, Iryna Rozum, Edward Comyn-Platt
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>